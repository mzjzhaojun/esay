import{g as K,r as _,a as o,b as m,c as i,w as t,d as a,u as n,i as p,n as v,k as b,e as $,m as B,j as F,F as W,q as X}from"./index-3e58188c.js";const Y=["src"],Z={style:{width:"300px"}},le={__name:"merchantwithdraw",setup(ee){const{proxy:c}=K();let O=c.$store.user.useUserStore();const{userObj:R}=O;let r=_({}),d=_(!1),f=_(""),g=_({userid:R.id,type:22}),U=_([]),T=_({merchantid:[{required:!0,message:"请选择商户",trigger:"blur"}],accnumber:[{required:!0,message:"请选择卡或地址",trigger:"blur"}],merchantexchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],amount:[{required:!0,trigger:"change",validator:q}]});function q(s,l,V){return!l||l>r.value.totalincome?V(new Error("请输入金额,并且不能大于可用余额")):V()}function w(){c.$refs.baseTableRef.refresh()}function L(){S(),r.value={},f.value="add",d.value=!0}async function S(){let s=await c.$api.merchantaccount.bank();U.value=s.body.listbanks,r.value={totalincome:s.body.balance}}async function N(s){let l=await c.$api.merchantaccountorder.canclewithdraw(s.id);c.submitOk(l.message),w()}function j(){c.$refs.dataFormRef.validate(async s=>{if(s){r.value.id=null;let l=await c.$api.merchantaccountorder.withdraw(r.value);c.submitOk(l.message),w(),d.value=!1}})}return(s,l)=>{const V=o("base-input"),x=o("el-col"),D=o("base-select-no"),k=o("el-button"),A=o("el-row"),E=o("base-header"),u=o("el-table-column"),C=o("el-tag"),I=o("base-confirm-btn"),M=o("base-table-p"),P=o("base-content"),Q=o("el-option"),z=o("el-select"),y=o("el-form-item"),h=o("base-input-no"),G=o("el-form"),H=o("base-dialog"),J=o("base-wrapper");return m(),i(J,null,{default:t(()=>[a(E,null,{default:t(()=>[a(A,null,{default:t(()=>[a(x,{span:4.5},{default:t(()=>[a(V,{modelValue:n(g).nikname,"onUpdate:modelValue":l[0]||(l[0]=e=>n(g).nikname=e),label:"充值金额",onClear:w},null,8,["modelValue"])]),_:1}),a(x,{span:4.5},{default:t(()=>[a(D,{modelValue:n(g).status,"onUpdate:modelValue":l[1]||(l[1]=e=>n(g).status=e),label:"状态","tag-type":"success",onClear:w,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:s.statusList},null,8,["modelValue","dataList"])]),_:1}),a(x,{span:4.5},{default:t(()=>[a(k,{type:"primary",onClick:w},{default:t(()=>[p("查询")]),_:1}),a(k,{type:"success",onClick:L},{default:t(()=>[p("提现")]),_:1})]),_:1})]),_:1})]),_:1}),a(P,null,{default:t(()=>[a(M,{ref:"baseTableRef",api:"merchantaccountorder.page",params:n(g),indexCode:!0},{default:t(()=>[a(u,{label:"提现单号",prop:"ordernum",width:"180px;"}),a(u,{label:"账户名字",prop:"accname"}),a(u,{label:"卡号/地址",prop:"accnumber",width:"280px;"}),a(u,{label:"RMB金额",prop:"amount"}),a(u,{label:"结算汇率",prop:"merchantexchange"},{default:t(e=>[e.row.merchantexchange?(m(),i(C,{key:0,type:"danger"},{default:t(()=>[p(v(e.row.merchantexchange),1)]),_:2},1024)):b("",!0)]),_:1}),a(u,{label:"USDT",prop:"amountreceived"},{default:t(e=>[e.row.amountreceived?(m(),i(C,{key:0,type:"success"},{default:t(()=>[p(v((e.row.amount/e.row.merchantexchange).toFixed(2)),1)]),_:2},1024)):b("",!0)]),_:1}),a(u,{label:"状态"},{default:t(e=>[e.row.statusname?(m(),i(C,{key:0},{default:t(()=>[p(v(e.row.statusname),1)]),_:2},1024)):b("",!0)]),_:1}),a(u,{label:"支付凭证",prop:"avatarUrl"},{default:t(e=>[$("span",null,[e.row.imgurl?(m(),B("img",{key:0,src:e.row.imgurl,alt:"",class:"img-sm"},null,8,Y)):b("",!0)])]),_:1}),a(u,{label:"创建时间",prop:"create_time"}),a(u,{label:"备注",prop:"remark"}),a(u,{label:"操作",width:"100"},{default:t(e=>[e.row.status==10?(m(),i(I,{key:0,type:"success",onOk:ae=>N(e.row),label:"取消"},null,8,["onOk"])):b("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(f)==="add"||n(f)==="update"?(m(),i(H,{key:0,modelValue:n(d),"onUpdate:modelValue":l[8]||(l[8]=e=>F(d)?d.value=e:d=e),title:s.dialogTitleObj[n(f)],width:"25%"},{footer:t(()=>[a(k,{onClick:l[7]||(l[7]=e=>F(d)?d.value=!1:d=!1)},{default:t(()=>[p("取 消")]),_:1}),a(k,{type:"primary",onClick:j},{default:t(()=>[p("确 定")]),_:1})]),default:t(()=>[a(G,{ref:"dataFormRef",rules:n(T),model:n(r),"label-width":"100px"},{default:t(()=>[a(y,{label:"卡号/地址:",prop:"accnumber"},{default:t(()=>[a(z,{modelValue:n(r).accnumber,"onUpdate:modelValue":l[2]||(l[2]=e=>n(r).accnumber=e),placeholder:"请选择卡类型",style:{}},{default:t(()=>[(m(!0),B(W,null,X(n(U),e=>(m(),i(Q,{key:e.id,value:e.id,label:e.accnumber},{default:t(()=>[$("span",Z,v(e.accnumber),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(y,{label:"可用余额:",prop:"totalincome"},{default:t(()=>[a(h,{modelValue:n(r).totalincome,"onUpdate:modelValue":l[3]||(l[3]=e=>n(r).totalincome=e),disabled:n(f)=="add"},null,8,["modelValue","disabled"])]),_:1}),a(y,{label:"结算汇率:",prop:"merchantexchange"},{default:t(()=>[a(h,{modelValue:n(r).merchantexchange,"onUpdate:modelValue":l[4]||(l[4]=e=>n(r).merchantexchange=e)},null,8,["modelValue"])]),_:1}),a(y,{label:"金额:",prop:"amount"},{default:t(()=>[a(h,{modelValue:n(r).amount,"onUpdate:modelValue":l[5]||(l[5]=e=>n(r).amount=e)},null,8,["modelValue"])]),_:1}),a(y,{label:"备注:",prop:"remark"},{default:t(()=>[a(h,{modelValue:n(r).remark,"onUpdate:modelValue":l[6]||(l[6]=e=>n(r).remark=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):b("",!0)]),_:1})}}};export{le as default};

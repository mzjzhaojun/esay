import{g as W,r as y,a as o,b as c,c as b,w as t,d as a,u as n,i,n as v,k as f,j as x}from"./index-3e58188c.js";const Z={__name:"orderchannel",setup(X){const{proxy:d}=W();let u=y({}),r=y(!1),g=y(""),C=y({}),p=y({type:20}),$=y({channelid:[{required:!0,message:"请选择渠道",trigger:"blur"}],exchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],channelexchange:[{required:!0,message:"请输入浮动汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function _(){d.$refs.baseTableRef.refresh()}function R(){u.value={},U(),g.value="add",r.value=!0}async function U(){let s=await d.$api.payconfig.get();u.value=s.body,d.submitOk(s.message)}function T(s){C.value=s,g.value="confirm",r.value=!0}async function q(){g.value="add",r.value=!1;let s=await d.$api.channelaccountorder.pass(C.value.id);d.submitOk(s.message),_()}async function S(s){let l=await d.$api.channelaccountorder.turndown(s.id);_(),d.submitOk(l.message)}function B(){d.$refs.dataFormRef.validate(async s=>{if(s){u.value.id=null;let l=await d.$api.channelaccountorder[u.value.id?"update":"add"](u.value);d.submitOk(l.message),_(),r.value=!1}})}async function F(s){let l=await d.$api.channel.get(s);u.value.channelexchange=l.body.downpoint}return(s,l)=>{const L=o("base-input"),N=o("base-select-no"),P=o("base-datetime"),j=o("base-datetime-no"),V=o("el-button"),D=o("el-col"),A=o("el-row"),E=o("base-header"),m=o("el-table-column"),w=o("el-tag"),O=o("base-confirm-btn"),I=o("base-table-p"),M=o("base-content"),Q=o("base-cascader-no"),h=o("el-form-item"),k=o("base-input-no"),z=o("el-form"),G=o("base-dialog"),H=o("authenticator-dialog"),J=o("base-wrapper");return c(),b(J,null,{default:t(()=>[a(E,null,{default:t(()=>[a(A,null,{default:t(()=>[a(D,null,{default:t(()=>[a(L,{modelValue:n(p).agentname,"onUpdate:modelValue":l[0]||(l[0]=e=>n(p).agentname=e),label:"渠道名称",onClear:_},null,8,["modelValue"]),a(N,{modelValue:n(p).status,"onUpdate:modelValue":l[1]||(l[1]=e=>n(p).status=e),label:"状态","tag-type":"success",onClear:_,style:{"margin-right":"5px",width:"200px"},clearable:"","option-props":{label:"name",value:"value"},dataList:s.statusList},null,8,["modelValue","dataList"]),a(P,{modelValue:n(p).agentname,"onUpdate:modelValue":l[2]||(l[2]=e=>n(p).agentname=e),label:"时间",onClear:_},null,8,["modelValue"]),i("至 "),a(j,{modelValue:n(p).agentname,"onUpdate:modelValue":l[3]||(l[3]=e=>n(p).agentname=e),onClear:_},null,8,["modelValue"]),a(V,{type:"primary",onClick:_},{default:t(()=>[i("查询")]),_:1}),a(V,{type:"success",onClick:R},{default:t(()=>[i("渠道充值")]),_:1})]),_:1})]),_:1})]),_:1}),a(M,null,{default:t(()=>[a(I,{ref:"baseTableRef",api:"channelaccountorder.page",params:n(p),indexCode:!0},{default:t(()=>[a(m,{label:"商户名称",prop:"username"}),a(m,{label:"商户编码",prop:"channelcode"}),a(m,{label:"标签",prop:"nkname"}),a(m,{label:"充值U金额",prop:"amount"}),a(m,{label:"充值汇率",prop:"exchange"},{default:t(e=>[e.row.exchange?(c(),b(w,{key:0,type:"success"},{default:t(()=>[i(v(e.row.exchange)+"%",1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"充值汇率浮动",prop:"channelexchange"},{default:t(e=>[e.row.channelexchange?(c(),b(w,{key:0,type:"success"},{default:t(()=>[i(v(e.row.channelexchange),1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"到账RMB金额",prop:"amountreceived"},{default:t(e=>[e.row.amountreceived?(c(),b(w,{key:0,type:"success"},{default:t(()=>[i(v(e.row.amountreceived),1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"状态"},{default:t(e=>[e.row.statusname?(c(),b(w,{key:0},{default:t(()=>[i(v(e.row.statusname),1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"创建时间",prop:"create_time"}),a(m,{label:"备注",prop:"remark"}),a(m,{label:"操作",width:"100"},{default:t(e=>[e.row.status==10?(c(),b(O,{key:0,type:"success",onOk:K=>T(e.row),label:"确认"},null,8,["onOk"])):f("",!0),e.row.status==10?(c(),b(O,{key:1,type:"warning",onOk:K=>S(e.row),label:"拒绝"},null,8,["onOk"])):f("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(g)==="add"||n(g)==="update"?(c(),b(G,{key:0,modelValue:n(r),"onUpdate:modelValue":l[10]||(l[10]=e=>x(r)?r.value=e:r=e),title:s.dialogTitleObj[n(g)],width:"27%"},{footer:t(()=>[a(V,{onClick:l[9]||(l[9]=e=>x(r)?r.value=!1:r=!1)},{default:t(()=>[i("取 消")]),_:1}),a(V,{type:"primary",onClick:B},{default:t(()=>[i("确 定")]),_:1})]),default:t(()=>[a(z,{ref:"dataFormRef",rules:n($),model:n(u),"label-width":"110px"},{default:t(()=>[a(h,{label:"选择商户:",prop:"channelid"},{default:t(()=>[a(Q,{modelValue:n(u).channelid,"onUpdate:modelValue":l[4]||(l[4]=e=>n(u).channelid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"channel.list",onOk:F},null,8,["modelValue"])]),_:1}),a(h,{label:"充值金额:",prop:"amount"},{default:t(()=>[a(k,{modelValue:n(u).amount,"onUpdate:modelValue":l[5]||(l[5]=e=>n(u).amount=e)},null,8,["modelValue"])]),_:1}),a(h,{label:"充值汇率:",prop:"exchange"},{default:t(()=>[a(k,{modelValue:n(u).exchange,"onUpdate:modelValue":l[6]||(l[6]=e=>n(u).exchange=e)},null,8,["modelValue"]),a(V,{style:{"margin-left":"10px"},type:"warning",onClick:U},{default:t(()=>[i("刷新")]),_:1})]),_:1}),a(h,{label:"充值汇率浮动:",prop:"channelexchange"},{default:t(()=>[a(k,{modelValue:n(u).channelexchange,"onUpdate:modelValue":l[7]||(l[7]=e=>n(u).channelexchange=e),label:"上下浮动汇率"},null,8,["modelValue"])]),_:1}),a(h,{label:"备注:",prop:"remark"},{default:t(()=>[a(k,{modelValue:n(u).remark,"onUpdate:modelValue":l[8]||(l[8]=e=>n(u).remark=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):f("",!0),n(g)=="confirm"?(c(),b(H,{key:1,modelValue:n(r),"onUpdate:modelValue":l[11]||(l[11]=e=>x(r)?r.value=e:r=e),"append-to-body":"",title:"安全验证",onConfirms:q},null,8,["modelValue"])):f("",!0)]),_:1})}}};export{Z as default};

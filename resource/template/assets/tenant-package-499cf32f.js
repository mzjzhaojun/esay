import{g as K,r as c,o as Q,a as s,b as V,c as y,w as t,d as e,u as o,i as p,k as T,j as h,e as q}from"./index-995db30f.js";const z={style:{height:"400px",width:"100%"},class:"overflow-y-auto"},J={__name:"tenant-package",setup(G){const{proxy:m}=K();let g=c({}),n=c({}),r=c(!1),k=c("");function b(){m.$refs.baseTableRef.refresh()}Q(()=>{});async function C(){return(await m.$api.sys_menu.tree({isOnlySystemAdminRePerm:!0})).body}async function R(){let u=await C();w(u,[]),n.value={sort:100,status:1,menuTree:u},k.value="add",r.value=!0}async function $(u){n.value=Object.assign({},u);let a=await C();w(a,form.menuIdList),form.menuTree=a,k.value="update",r.value=!0}function w(u,a){u.forEach(d=>{d.isHasPerm=!1,a.includes(d.id)&&(d.isHasPerm=!0),d.children.length>0&&w(d.children,a)})}async function O(u){let a=await m.$api.sys_tenant_package.delete(u.id);b(),m.submitOk(a.message)}function M(){m.$refs.dataFormRef.validate(async u=>{if(u){let a=m.$refs.menuTreeRef.getCheckedKeys();form.menuIdList=a;let d=await m.$api.sys_tenant_package[n.value.id?"update":"add"](n.value);m.submitOk(d.message),b(),r.value=!1}})}return(u,a)=>{const d=s("base-input"),_=s("el-button"),N=s("base-header"),i=s("el-table-column"),j=s("base-tag"),B=s("base-delete-btn"),D=s("base-table-p"),F=s("base-content"),x=s("base-input-no"),f=s("el-form-item"),U=s("el-radio"),P=s("el-radio-group"),A=s("menu-perm-tree"),H=s("el-input-number"),L=s("el-form"),S=s("base-dialog"),E=s("base-wrapper");return V(),y(E,null,{default:t(()=>[e(N,null,{default:t(()=>[e(d,{modelValue:o(g).name,"onUpdate:modelValue":a[0]||(a[0]=l=>o(g).name=l),label:"套餐名",style:{width:"200px"},clearable:"",onClear:b},null,8,["modelValue"]),e(_,{type:"primary",onClick:b},{default:t(()=>[p("查询")]),_:1}),e(_,{type:"success",onClick:R},{default:t(()=>[p("添加")]),_:1})]),_:1}),e(F,null,{default:t(()=>[e(D,{ref:"baseTableRef",api:"sys_tenant_package.page",params:o(g),indexCode:!0},{default:t(()=>[e(i,{label:"ID",prop:"id"}),e(i,{label:"套餐名",prop:"name"}),e(i,{label:"状态",prop:"status"},{default:t(l=>[e(j,{modelValue:l.row.status,"onUpdate:modelValue":v=>l.row.status=v},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(i,{label:"排序",prop:"sort"}),e(i,{label:"备注",prop:"remark"}),e(i,{label:"创建时间",prop:"createTime"}),e(i,{label:"操作"},{default:t(l=>[l.row.id!==1?(V(),y(_,{key:0,link:"",onClick:v=>$(l.row)},{default:t(()=>[p("编辑")]),_:2},1032,["onClick"])):T("",!0),l.row.id!==1?(V(),y(B,{key:1,onOk:v=>O(l.row)},null,8,["onOk"])):T("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),e(S,{modelValue:o(r),"onUpdate:modelValue":a[7]||(a[7]=l=>h(r)?r.value=l:r=l),title:u.dialogTitleObj[o(k)],width:"25%"},{footer:t(()=>[e(_,{onClick:a[6]||(a[6]=l=>h(r)?r.value=!1:r=!1)},{default:t(()=>[p("取 消")]),_:1}),e(_,{type:"primary",onClick:M},{default:t(()=>[p("确 定")]),_:1})]),default:t(()=>[e(L,{ref:"dataFormRef",model:o(n),"label-width":"100px"},{default:t(()=>[e(f,{label:"套餐名:"},{default:t(()=>[e(x,{modelValue:o(n).name,"onUpdate:modelValue":a[1]||(a[1]=l=>o(n).name=l)},null,8,["modelValue"])]),_:1}),e(f,{label:"状态:"},{default:t(()=>[e(P,{modelValue:o(n).status,"onUpdate:modelValue":a[2]||(a[2]=l=>o(n).status=l)},{default:t(()=>[e(U,{label:1},{default:t(()=>[p("正常")]),_:1}),e(U,{label:0},{default:t(()=>[p("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"菜单权限:"},{default:t(()=>[q("div",z,[o(r)&&o(n).menuTree&&o(n).menuTree.length>0?(V(),y(A,{key:0,ref:"menuTreeRef",modelValue:o(n).menuTree,"onUpdate:modelValue":a[3]||(a[3]=l=>o(n).menuTree=l)},null,8,["modelValue"])):T("",!0)])]),_:1}),e(f,{label:"排序:"},{default:t(()=>[e(H,{modelValue:o(n).sort,"onUpdate:modelValue":a[4]||(a[4]=l=>o(n).sort=l),min:1,"controls-position":"right",placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(f,{label:"备注:"},{default:t(()=>[e(x,{modelValue:o(n).remark,"onUpdate:modelValue":a[5]||(a[5]=l=>o(n).remark=l),rows:2,type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]),_:1})}}};export{J as default};

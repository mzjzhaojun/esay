import{g as le,t as te,r as f,a as o,b as m,c,w as n,d as a,u as t,i as _,n as v,k as g,e as $,m as R,j as C,F as ne,q as oe}from"./index-0a9dd1d5.js";const re=["src"],ue={style:{width:"300px"}},me={__name:"withdrawagent",setup(se){const{proxy:i}=le();let B=i.$store.user.useUserStore();te(B);let r=f({}),s=f(!1),w=f(""),p=f({type:21}),U=f({}),h=f([]),S=f({agentid:[{required:!0,message:"请选择商户",trigger:"blur"}],accnumber:[{required:!0,message:"请选择卡/地址",trigger:"blur"}],agentexchange:[{required:!0,message:"请输入商户结算汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function b(){i.$refs.baseTableRef.refresh()}function T(){r.value={},w.value="add",s.value=!0}function q(u){u!=null&&F(u)}async function F(u){let l=await i.$api.agentaccount.getbank(u);h.value=l.body.listbanks,r.value={agentid:u,totalincome:l.body.totalincome}}function L(u){U=u,w.value="confirm",s.value=!0}async function N(){w.value="add",s.value=!1;let u=await i.$api.agentaccountorder.passwithdraw(U.id);i.submitOk(u.message),b()}async function P(u){let l=await i.$api.agentaccountorder.turndownwithdraw(u.id);b(),i.submitOk(l.message)}function j(){i.$refs.dataFormRef.validate(async u=>{if(u){r.value.id=null;let l=await i.$api.agentaccountorder.withdraw(r.value);i.submitOk(l.message),b(),s.value=!1}})}return(u,l)=>{const D=o("base-input"),A=o("base-select-no"),E=o("base-datetime"),I=o("base-datetime-no"),y=o("el-button"),M=o("el-col"),Q=o("el-row"),z=o("base-header"),d=o("el-table-column"),x=o("el-tag"),O=o("base-confirm-btn"),G=o("base-table-p"),H=o("base-content"),J=o("base-cascader-no"),V=o("el-form-item"),K=o("el-option"),W=o("el-select"),k=o("base-input-no"),X=o("el-form"),Y=o("base-dialog"),Z=o("authenticator-dialog"),ee=o("base-wrapper");return m(),c(ee,null,{default:n(()=>[a(z,null,{default:n(()=>[a(Q,null,{default:n(()=>[a(M,null,{default:n(()=>[a(D,{modelValue:t(p).agentname,"onUpdate:modelValue":l[0]||(l[0]=e=>t(p).agentname=e),label:"代理名称",onClear:b},null,8,["modelValue"]),a(A,{modelValue:t(p).status,"onUpdate:modelValue":l[1]||(l[1]=e=>t(p).status=e),label:"状态","tag-type":"success",onClear:b,style:{"margin-right":"5px",width:"200px"},clearable:"","option-props":{label:"name",value:"value"},dataList:u.statusList},null,8,["modelValue","dataList"]),a(E,{modelValue:t(p).agentname,"onUpdate:modelValue":l[2]||(l[2]=e=>t(p).agentname=e),label:"时间",onClear:b},null,8,["modelValue"]),_("至 "),a(I,{modelValue:t(p).agentname,"onUpdate:modelValue":l[3]||(l[3]=e=>t(p).agentname=e),onClear:b},null,8,["modelValue"]),a(y,{type:"primary",onClick:b},{default:n(()=>[_("查询")]),_:1}),a(y,{type:"success",onClick:T},{default:n(()=>[_("代理提现")]),_:1})]),_:1})]),_:1})]),_:1}),a(H,null,{default:n(()=>[a(G,{ref:"baseTableRef",api:"agentaccountorder.page",params:t(p),":indexCode":!0},{default:n(()=>[a(d,{label:"提现单号",prop:"ordernum",width:"180px;"}),a(d,{label:"代理名称",prop:"username"}),a(d,{label:"标签",prop:"nkname"}),a(d,{label:"账户名字",prop:"accname"}),a(d,{label:"卡号/地址",prop:"accnumber",width:"180px;"}),a(d,{label:"提现汇率",prop:"agentexchange"},{default:n(e=>[e.row.agentexchange?(m(),c(x,{key:0,type:"danger"},{default:n(()=>[_(v(e.row.exchange),1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"到账RMB金额",prop:"accnumber"},{default:n(e=>[e.row.amountreceived?(m(),c(x,{key:0,type:"success"},{default:n(()=>[_(v(e.row.amountreceived),1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"状态"},{default:n(e=>[e.row.statusname?(m(),c(x,{key:0},{default:n(()=>[_(v(e.row.statusname),1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"支付凭证",prop:"avatarUrl"},{default:n(e=>[$("span",null,[e.row.imgurl?(m(),R("img",{key:0,src:e.row.imgurl,alt:"",class:"img-sm"},null,8,re)):g("",!0)])]),_:1}),a(d,{label:"创建时间",prop:"create_time"}),a(d,{label:"备注",prop:"remark"}),a(d,{label:"操作",width:"100"},{default:n(e=>[e.row.status==10?(m(),c(O,{key:0,type:"success",onOk:ae=>L(e.row),label:"确认"},null,8,["onOk"])):g("",!0),e.row.status==10?(m(),c(O,{key:1,type:"warning",onOk:ae=>P(e.row),label:"拒绝"},null,8,["onOk"])):g("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),t(w)==="add"?(m(),c(Y,{key:0,modelValue:t(s),"onUpdate:modelValue":l[12]||(l[12]=e=>C(s)?s.value=e:s=e),title:u.dialogTitleObj[t(w)],width:"23%"},{footer:n(()=>[a(y,{onClick:l[11]||(l[11]=e=>C(s)?s.value=!1:s=!1)},{default:n(()=>[_("取 消")]),_:1}),a(y,{type:"primary",onClick:j},{default:n(()=>[_("确 定")]),_:1})]),default:n(()=>[a(X,{ref:"dataFormRef",model:t(r),rules:t(S),"label-width":"110px"},{default:n(()=>[a(V,{label:"选择代理:",prop:"agentid"},{default:n(()=>[a(J,{modelValue:t(r).agentid,"onUpdate:modelValue":l[4]||(l[4]=e=>t(r).agentid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"agent.list",onOk:l[5]||(l[5]=e=>q(t(r).agentid))},null,8,["modelValue"])]),_:1}),a(V,{label:"卡号/地址:",prop:"accnumber"},{default:n(()=>[a(W,{modelValue:t(r).accnumber,"onUpdate:modelValue":l[6]||(l[6]=e=>t(r).accnumber=e),placeholder:"请选择卡类型",style:{}},{default:n(()=>[(m(!0),R(ne,null,oe(t(h),e=>(m(),c(K,{key:e.id,value:e.id,label:e.accnumber},{default:n(()=>[$("span",ue,v(e.accnumber),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(V,{label:"余额:",prop:"totalincome"},{default:n(()=>[a(k,{modelValue:t(r).totalincome,"onUpdate:modelValue":l[7]||(l[7]=e=>t(r).totalincome=e),disabled:!0},null,8,["modelValue"])]),_:1}),a(V,{label:"代理结算汇率:",prop:"agentexchange"},{default:n(()=>[a(k,{modelValue:t(r).agentexchange,"onUpdate:modelValue":l[8]||(l[8]=e=>t(r).agentexchange=e)},null,8,["modelValue"])]),_:1}),a(V,{label:"金额:",prop:"amount"},{default:n(()=>[a(k,{modelValue:t(r).amount,"onUpdate:modelValue":l[9]||(l[9]=e=>t(r).amount=e)},null,8,["modelValue"])]),_:1}),a(V,{label:"备注:",prop:"remark"},{default:n(()=>[a(k,{modelValue:t(r).remark,"onUpdate:modelValue":l[10]||(l[10]=e=>t(r).remark=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])):g("",!0),t(w)=="confirm"?(m(),c(Z,{key:1,modelValue:t(s),"onUpdate:modelValue":l[13]||(l[13]=e=>C(s)?s.value=e:s=e),"append-to-body":"",title:"安全验证",width:"15%",onConfirms:N},null,8,["modelValue"])):g("",!0)]),_:1})}}};export{me as default};

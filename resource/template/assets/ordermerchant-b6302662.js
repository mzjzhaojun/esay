import{g as W,r as w,a as o,b,c as _,w as t,d as a,u as n,i as p,n as v,k as g,j as x}from"./index-857f4c92.js";const Z={__name:"ordermerchant",setup(X){const{proxy:i}=W();let u=w({}),r=w(!1),f=w(""),C=w({}),m=w({type:20}),R=w({merchantid:[{required:!0,message:"请选择商户",trigger:"blur"}],accnumber:[{required:!0,message:"请选择卡或地址",trigger:"blur"}],merchantexchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function c(){i.$refs.baseTableRef.refresh()}function T(){u.value={},U(),f.value="add",r.value=!0}async function U(){let s=await i.$api.payconfig.get();u.value=s.body,i.submitOk(s.message)}function q(s){C.value=s,f.value="confirm",r.value=!0}async function B(){f.value="add",r.value=!1;let s=await i.$api.merchantaccountorder.pass(C.value.id);i.submitOk(s.message),c()}async function F(s){let l=await i.$api.merchantaccountorder.turndown(s.id);c(),i.submitOk(l.message)}function L(){i.$refs.dataFormRef.validate(async s=>{if(s){u.value.id=null;let l=await i.$api.merchantaccountorder[u.value.id?"update":"add"](u.value);i.submitOk(l.message),c(),r.value=!1}})}return(s,l)=>{const O=o("base-input"),N=o("base-select-no"),P=o("base-datetime"),S=o("base-datetime-no"),y=o("el-button"),j=o("el-col"),D=o("el-row"),z=o("base-header"),d=o("el-table-column"),V=o("el-tag"),A=o("el-image"),$=o("base-confirm-btn"),E=o("base-table-p"),I=o("base-content"),M=o("base-cascader-no"),k=o("el-form-item"),h=o("base-input-no"),Q=o("el-form"),G=o("base-dialog"),H=o("authenticator-dialog"),J=o("base-wrapper");return b(),_(J,null,{default:t(()=>[a(z,null,{default:t(()=>[a(D,null,{default:t(()=>[a(j,null,{default:t(()=>[a(O,{modelValue:n(m).agentname,"onUpdate:modelValue":l[0]||(l[0]=e=>n(m).agentname=e),label:"商户名称",onClear:c},null,8,["modelValue"]),a(O,{modelValue:n(m).agentname,"onUpdate:modelValue":l[1]||(l[1]=e=>n(m).agentname=e),label:"商户编码",onClear:c},null,8,["modelValue"]),a(N,{modelValue:n(m).status,"onUpdate:modelValue":l[2]||(l[2]=e=>n(m).status=e),label:"状态","tag-type":"success",onClear:c,style:{"margin-right":"5px",width:"200px"},clearable:"","option-props":{label:"name",value:"value"},dataList:s.statusList},null,8,["modelValue","dataList"]),a(P,{modelValue:n(m).agentname,"onUpdate:modelValue":l[3]||(l[3]=e=>n(m).agentname=e),label:"时间",onClear:c},null,8,["modelValue"]),p("至 "),a(S,{modelValue:n(m).agentname,"onUpdate:modelValue":l[4]||(l[4]=e=>n(m).agentname=e),onClear:c},null,8,["modelValue"]),a(y,{type:"primary",onClick:c},{default:t(()=>[p("查询")]),_:1}),a(y,{type:"success",onClick:T},{default:t(()=>[p("商户充值")]),_:1})]),_:1})]),_:1})]),_:1}),a(I,null,{default:t(()=>[a(E,{ref:"baseTableRef",api:"merchantaccountorder.page",params:n(m),indexCode:!0},{default:t(()=>[a(d,{label:"商户名称",prop:"username"}),a(d,{label:"商户编码",prop:"merchantcode"}),a(d,{label:"标签",prop:"nkname"}),a(d,{label:"充值U金额",prop:"amount"}),a(d,{label:"汇率",prop:"exchange"},{default:t(e=>[e.row.exchange?(b(),_(V,{key:0,type:"success"},{default:t(()=>[p(v(e.row.exchange)+"%",1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"结算汇率",prop:"merchantexchange"},{default:t(e=>[e.row.merchantexchange?(b(),_(V,{key:0,type:"success"},{default:t(()=>[p(v(e.row.exchange)+"%",1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"到账RMB金额",prop:"amountreceived"},{default:t(e=>[e.row.amountreceived?(b(),_(V,{key:0,type:"success"},{default:t(()=>[p(v(e.row.amountreceived),1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"状态"},{default:t(e=>[e.row.statusname?(b(),_(V,{key:0},{default:t(()=>[p(v(e.row.statusname),1)]),_:2},1024)):g("",!0)]),_:1}),a(d,{label:"创建时间",prop:"create_time"}),a(d,{label:"凭证",prop:"imgurl"},{default:t(e=>[a(A,{style:{width:"50px",height:"50px"},src:e.row.imgurl,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.row.imgurl],"initial-index":4,"preview-teleported":"true",fit:"cover"},null,8,["src","preview-src-list"])]),_:1}),a(d,{label:"备注",prop:"remark"}),a(d,{label:"操作",width:"100"},{default:t(e=>[e.row.status==10?(b(),_($,{key:0,type:"success",onOk:K=>q(e.row),label:"确认"},null,8,["onOk"])):g("",!0),e.row.status==10?(b(),_($,{key:1,type:"warning",onOk:K=>F(e.row),label:"拒绝"},null,8,["onOk"])):g("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(f)==="add"||n(f)==="update"?(b(),_(G,{key:0,modelValue:n(r),"onUpdate:modelValue":l[10]||(l[10]=e=>x(r)?r.value=e:r=e),title:s.dialogTitleObj[n(f)],width:"23%"},{footer:t(()=>[a(y,{onClick:l[9]||(l[9]=e=>x(r)?r.value=!1:r=!1)},{default:t(()=>[p("取 消")]),_:1}),a(y,{type:"primary",onClick:L},{default:t(()=>[p("确 定")]),_:1})]),default:t(()=>[a(Q,{ref:"dataFormRef",rules:n(R),model:n(u),"label-width":"100px"},{default:t(()=>[a(k,{label:"选择商户:",prop:"merchantid"},{default:t(()=>[a(M,{modelValue:n(u).merchantid,"onUpdate:modelValue":l[5]||(l[5]=e=>n(u).merchantid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"merchant.list"},null,8,["modelValue"])]),_:1}),a(k,{label:"充值金额:",prop:"amount"},{default:t(()=>[a(h,{modelValue:n(u).amount,"onUpdate:modelValue":l[6]||(l[6]=e=>n(u).amount=e)},null,8,["modelValue"])]),_:1}),a(k,{label:"汇率:"},{default:t(()=>[a(h,{modelValue:n(u).exchange,"onUpdate:modelValue":l[7]||(l[7]=e=>n(u).exchange=e),disabled:n(f)=="add"},null,8,["modelValue","disabled"]),a(y,{style:{"margin-left":"10px"},type:"warning",onClick:U},{default:t(()=>[p("刷新")]),_:1})]),_:1}),a(k,{label:"备注:",prop:"remark"},{default:t(()=>[a(h,{modelValue:n(u).remark,"onUpdate:modelValue":l[8]||(l[8]=e=>n(u).remark=e),type:"textarea",style:{width:"215px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):g("",!0),n(f)=="confirm"?(b(),_(H,{key:1,modelValue:n(r),"onUpdate:modelValue":l[11]||(l[11]=e=>x(r)?r.value=e:r=e),"append-to-body":"",title:"安全验证",width:"15%",onConfirms:B},null,8,["modelValue"])):g("",!0)]),_:1})}}};export{Z as default};

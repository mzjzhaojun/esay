import{g as X,r as y,o as Y,a as d,b as r,c as p,w as o,d as l,u as a,i as m,e as k,s as B,k as _,n as D,j as I,m as Z,F as ee,q as le}from"./index-3e58188c.js";const ae={class:"flex-start-center"},te={style:{"margin-left":"10px"}},oe={style:{float:"left",color:"#8492a6","font-size":"12px"}},ne={style:{float:"right"}},re={__name:"menu",setup(de){const{proxy:b}=X();let v=y({}),t=y({}),s=y(!1),w=y(""),L={name:[{required:!0,message:"名称不得为空",trigger:"blur"}],path:[{required:!0,message:"访问路径不得为空",trigger:"blur"}]},h=y([]),C=y([]);Y(()=>{V(),N()});async function V(){let u=await b.$api.sys_menu.tree(v.value);h.value=u.body}async function N(){let u=await b.$api.sys_dict.listFromCacheByCode("element_icon");C.value=u.body}function U(u){t.value={parent_id:u,type:1,sort:100,is_deleted:0,is_show:!0,is_show_breadcrumb:!0},w.value="add",s.value=!0}function P(u){t.value=Object.assign({},u),w.value="update",s.value=!0}async function j(u){let n=await b.$api.sys_menu.delete(u.id);V(),b.submitOk(n.message)}function q(){b.$refs.dataFormRef.validate(async u=>{if(u){(!t.value.parent_id||!isFinite(t.value.parent_id))&&(t.value.parent_id=0);let n=await b.$api.sys_menu[t.value.id?"update":"add"](t.value);b.submitOk(n.message),V(),s.value=!1}})}return(u,n)=>{const z=d("base-input"),f=d("el-button"),R=d("base-header"),c=d("el-table-column"),x=d("el-icon"),S=d("base-delete-btn"),T=d("base-table"),M=d("base-content"),A=d("base-cascader"),i=d("el-form-item"),g=d("base-input-no"),$=d("el-radio"),E=d("el-radio-group"),Q=d("el-option"),G=d("el-select"),F=d("base-radio-group"),H=d("el-input-number"),J=d("el-form"),K=d("base-dialog"),W=d("base-wrapper");return r(),p(W,null,{default:o(()=>[l(R,null,{default:o(()=>[l(z,{modelValue:a(v).name,"onUpdate:modelValue":n[0]||(n[0]=e=>a(v).name=e),label:"名称",onClear:V},null,8,["modelValue"]),l(f,{type:"primary",onClick:V},{default:o(()=>[m("查询")]),_:1}),l(f,{type:"success",onClick:U},{default:o(()=>[m("添加")]),_:1})]),_:1}),l(M,null,{default:o(()=>[l(T,{"row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},data:a(h),"default-expand-all":""},{default:o(()=>[l(c,{label:"ID",prop:"id"}),l(c,{label:"名称",align:"left"},{default:o(e=>[k("div",ae,[l(x,{size:"15"},{default:o(()=>[e.row.icon?(r(),p(B(e.row.icon),{key:0})):_("",!0)]),_:2},1024),k("span",te,D(e.row.name),1)])]),_:1}),l(c,{label:"访问路径",prop:"path",align:"left"}),l(c,{label:"组件名",prop:"component",align:"left"}),l(c,{label:"按钮权限",prop:"btnPerm",align:"left"}),l(c,{label:"排序",prop:"sort"}),l(c,{label:"操作"},{default:o(e=>[l(f,{link:"",onClick:O=>P(e.row)},{default:o(()=>[m("编辑")]),_:2},1032,["onClick"]),l(f,{type:"primary",link:"",onClick:O=>U(e.row.id)},{default:o(()=>[m("新增子项")]),_:2},1032,["onClick"]),l(S,{onOk:O=>j(e.row)},null,8,["onOk"])]),_:1})]),_:1},8,["data"])]),_:1}),l(K,{modelValue:a(s),"onUpdate:modelValue":n[13]||(n[13]=e=>I(s)?s.value=e:s=e),title:u.dialogTitleObj[a(w)],width:"25%"},{footer:o(()=>[l(f,{onClick:n[12]||(n[12]=e=>I(s)?s.value=!1:s=!1)},{default:o(()=>[m("取 消")]),_:1}),l(f,{type:"primary",onClick:q},{default:o(()=>[m("确 定")]),_:1})]),default:o(()=>[l(J,{ref:"dataFormRef",model:a(t),rules:a(L),"label-width":"120px"},{default:o(()=>[l(i,{label:"父菜单:"},{default:o(()=>[a(s)?(r(),p(A,{key:0,modelValue:a(t).parent_id,"onUpdate:modelValue":n[1]||(n[1]=e=>a(t).parent_id=e),clearable:"",params:{excludeMenuId:a(t).id},placeholder:"请选择(为空时标识顶级)",props:{value:"id",label:"name",children:"children",checkStrictly:!0,emitPath:!1},api:"sys_menu.tree"},null,8,["modelValue","params"])):_("",!0)]),_:1}),l(i,{label:"名称:",prop:"name"},{default:o(()=>[l(g,{modelValue:a(t).name,"onUpdate:modelValue":n[2]||(n[2]=e=>a(t).name=e)},null,8,["modelValue"])]),_:1}),l(i,{label:"类型:"},{default:o(()=>[l(E,{modelValue:a(t).type,"onUpdate:modelValue":n[3]||(n[3]=e=>a(t).type=e)},{default:o(()=>[l($,{label:1},{default:o(()=>[m("菜单")]),_:1}),l($,{label:2},{default:o(()=>[m("按钮")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"访问路径:",prop:"path"},{default:o(()=>[l(g,{modelValue:a(t).path,"onUpdate:modelValue":n[4]||(n[4]=e=>a(t).path=e),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(t).type==1?(r(),p(i,{key:0,label:"组件:",prop:"component"},{default:o(()=>[l(g,{modelValue:a(t).component,"onUpdate:modelValue":n[5]||(n[5]=e=>a(t).component=e),placeholder:"请输入菜单对应的文件路径"},null,8,["modelValue"])]),_:1})):_("",!0),a(t).type==2?(r(),p(i,{key:1,label:"按钮权限标识："},{default:o(()=>[l(g,{modelValue:a(t).btnPerm,"onUpdate:modelValue":n[6]||(n[6]=e=>a(t).btnPerm=e),placeholder:"sys:user:add"},null,8,["modelValue"])]),_:1})):_("",!0),a(t).type==1?(r(),p(i,{key:2,label:"图标:"},{default:o(()=>[l(G,{modelValue:a(t).icon,"onUpdate:modelValue":n[7]||(n[7]=e=>a(t).icon=e),placeholder:"请选择图标",style:{width:"200px"},filterable:"",clearable:"","allow-create":""},{default:o(()=>[(r(!0),Z(ee,null,le(a(C),e=>(r(),p(Q,{key:e.name,value:e.name,label:e.name},{default:o(()=>[k("span",oe,D(e.name),1),k("div",ne,[l(x,{size:"16"},{default:o(()=>[(r(),p(B(e.name)))]),_:2},1024)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})):_("",!0),a(t).type==1?(r(),p(i,{key:3,label:"重定向路径:"},{default:o(()=>[l(g,{modelValue:a(t).redirect,"onUpdate:modelValue":n[8]||(n[8]=e=>a(t).redirect=e),placeholder:"输入重定向路径"},null,8,["modelValue"])]),_:1})):_("",!0),a(t).type==1?(r(),p(i,{key:4,label:"是否显示:"},{default:o(()=>[l(F,{modelValue:a(t).is_show,"onUpdate:modelValue":n[9]||(n[9]=e=>a(t).is_show=e),"data-type":"yes"},null,8,["modelValue"])]),_:1})):_("",!0),a(t).type==1?(r(),p(i,{key:5,label:"是否显示面包屑:"},{default:o(()=>[l(F,{modelValue:a(t).is_show_breadcrumb,"onUpdate:modelValue":n[10]||(n[10]=e=>a(t).is_show_breadcrumb=e),"data-type":"yes"},null,8,["modelValue"])]),_:1})):_("",!0),l(i,{label:"排序:"},{default:o(()=>[l(H,{modelValue:a(t).sort,"onUpdate:modelValue":n[11]||(n[11]=e=>a(t).sort=e),min:1,"controls-position":"right",placeholder:"请输入排序"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])]),_:1})}}};export{re as default};

import{g as ee,t as ae,r as b,a as o,b as m,c as p,w as l,d as a,u as n,i as _,n as v,k as c,e as R,m as B,j as C,F as te,q as le}from"./index-fc9417a1.js";const ne=["src"],oe={style:{width:"300px"}},se={__name:"withdrawagent",setup(re){const{proxy:i}=ee();let S=i.$store.user.useUserStore();ae(S);let r=b({}),s=b(!1),f=b(""),k=b({type:21}),U=b({}),O=b([]),T=b({agentid:[{required:!0,message:"请选择商户",trigger:"blur"}],accnumber:[{required:!0,message:"请选择卡/地址",trigger:"blur"}],agentexchange:[{required:!0,message:"请输入商户结算汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function g(){i.$refs.baseTableRef.refresh()}function q(){r.value={},f.value="add",s.value=!0}function F(u){u!=null&&L(u)}async function L(u){let t=await i.$api.agentaccount.getbank(u);O.value=t.body.listbanks,r.value={agentid:u,totalincome:t.body.totalincome}}function N(u){U=u,f.value="confirm",s.value=!0}async function P(){f.value="add",s.value=!1;let u=await i.$api.agentaccountorder.passwithdraw(U.id);i.submitOk(u.message),g()}async function j(u){let t=await i.$api.agentaccountorder.turndownwithdraw(u.id);g(),i.submitOk(t.message)}function D(){i.$refs.dataFormRef.validate(async u=>{if(u){r.value.id=null;let t=await i.$api.agentaccountorder.withdraw(r.value);i.submitOk(t.message),g(),s.value=!1}})}return(u,t)=>{const A=o("base-input"),x=o("el-col"),E=o("base-select-no"),y=o("el-button"),I=o("el-row"),M=o("base-header"),d=o("el-table-column"),h=o("el-tag"),$=o("base-confirm-btn"),Q=o("base-table-p"),z=o("base-content"),G=o("base-cascader-no"),w=o("el-form-item"),H=o("el-option"),J=o("el-select"),V=o("base-input-no"),K=o("el-form"),W=o("base-dialog"),X=o("authenticator-dialog"),Y=o("base-wrapper");return m(),p(Y,null,{default:l(()=>[a(M,null,{default:l(()=>[a(I,null,{default:l(()=>[a(x,{span:4.5},{default:l(()=>[a(A,{modelValue:n(k).nikname,"onUpdate:modelValue":t[0]||(t[0]=e=>n(k).nikname=e),label:"充值金额",onClear:g},null,8,["modelValue"])]),_:1}),a(x,{span:4.5},{default:l(()=>[a(E,{modelValue:n(k).status,"onUpdate:modelValue":t[1]||(t[1]=e=>n(k).status=e),label:"状态","tag-type":"success",onClear:g,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:u.statusList},null,8,["modelValue","dataList"])]),_:1}),a(x,{span:4.5},{default:l(()=>[a(y,{type:"primary",onClick:g},{default:l(()=>[_("查询")]),_:1}),a(y,{type:"success",onClick:q},{default:l(()=>[_("创建提现")]),_:1})]),_:1})]),_:1})]),_:1}),a(z,null,{default:l(()=>[a(Q,{ref:"baseTableRef",api:"agentaccountorder.page",params:n(k),":indexCode":!0},{default:l(()=>[a(d,{label:"提现单号",prop:"ordernum",width:"180px;"}),a(d,{label:"代理名称",prop:"username"}),a(d,{label:"标签",prop:"nkname"}),a(d,{label:"账户名字",prop:"accname"}),a(d,{label:"卡号/地址",prop:"accnumber",width:"180px;"}),a(d,{label:"结算汇率",prop:"agentexchange"},{default:l(e=>[e.row.agentexchange?(m(),p(h,{key:0,type:"danger"},{default:l(()=>[_(v(e.row.exchange)+"%",1)]),_:2},1024)):c("",!0)]),_:1}),a(d,{label:"到账RMB金额",prop:"accnumber"},{default:l(e=>[e.row.amountreceived?(m(),p(h,{key:0,type:"success"},{default:l(()=>[_(v(e.row.amountreceived),1)]),_:2},1024)):c("",!0)]),_:1}),a(d,{label:"状态"},{default:l(e=>[e.row.statusname?(m(),p(h,{key:0},{default:l(()=>[_(v(e.row.statusname),1)]),_:2},1024)):c("",!0)]),_:1}),a(d,{label:"支付凭证",prop:"avatarUrl"},{default:l(e=>[R("span",null,[e.row.imgurl?(m(),B("img",{key:0,src:e.row.imgurl,alt:"",class:"img-sm"},null,8,ne)):c("",!0)])]),_:1}),a(d,{label:"创建时间",prop:"create_time"}),a(d,{label:"备注",prop:"remark"}),a(d,{label:"操作",width:"100"},{default:l(e=>[e.row.status==10?(m(),p($,{key:0,type:"success",onOk:Z=>N(e.row),label:"确认"},null,8,["onOk"])):c("",!0),e.row.status==10?(m(),p($,{key:1,type:"warning",onOk:Z=>j(e.row),label:"拒绝"},null,8,["onOk"])):c("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(f)==="add"?(m(),p(W,{key:0,modelValue:n(s),"onUpdate:modelValue":t[10]||(t[10]=e=>C(s)?s.value=e:s=e),title:u.dialogTitleObj[n(f)],width:"22%"},{footer:l(()=>[a(y,{onClick:t[9]||(t[9]=e=>C(s)?s.value=!1:s=!1)},{default:l(()=>[_("取 消")]),_:1}),a(y,{type:"primary",onClick:D},{default:l(()=>[_("确 定")]),_:1})]),default:l(()=>[a(K,{ref:"dataFormRef",model:n(r),rules:n(T),"label-width":"110px"},{default:l(()=>[a(w,{label:"选择商户:",prop:"agentid"},{default:l(()=>[a(G,{modelValue:n(r).agentid,"onUpdate:modelValue":t[2]||(t[2]=e=>n(r).agentid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"agent.list",onOk:t[3]||(t[3]=e=>F(n(r).agentid))},null,8,["modelValue"])]),_:1}),a(w,{label:"卡号/地址:",prop:"accnumber"},{default:l(()=>[a(J,{modelValue:n(r).accnumber,"onUpdate:modelValue":t[4]||(t[4]=e=>n(r).accnumber=e),placeholder:"请选择卡类型",style:{}},{default:l(()=>[(m(!0),B(te,null,le(n(O),e=>(m(),p(H,{key:e.id,value:e.id,label:e.accnumber},{default:l(()=>[R("span",oe,v(e.accnumber),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(w,{label:"余额:",prop:"totalincome"},{default:l(()=>[a(V,{modelValue:n(r).totalincome,"onUpdate:modelValue":t[5]||(t[5]=e=>n(r).totalincome=e),disabled:!0},null,8,["modelValue"])]),_:1}),a(w,{label:"商户结算汇率:",prop:"agentexchange"},{default:l(()=>[a(V,{modelValue:n(r).agentexchange,"onUpdate:modelValue":t[6]||(t[6]=e=>n(r).agentexchange=e)},null,8,["modelValue"])]),_:1}),a(w,{label:"金额:",prop:"amount"},{default:l(()=>[a(V,{modelValue:n(r).amount,"onUpdate:modelValue":t[7]||(t[7]=e=>n(r).amount=e)},null,8,["modelValue"])]),_:1}),a(w,{label:"备注:",prop:"remark"},{default:l(()=>[a(V,{modelValue:n(r).remark,"onUpdate:modelValue":t[8]||(t[8]=e=>n(r).remark=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])):c("",!0),n(f)=="confirm"?(m(),p(X,{key:1,modelValue:n(s),"onUpdate:modelValue":t[11]||(t[11]=e=>C(s)?s.value=e:s=e),"append-to-body":"",title:"安全验证",width:"15%",onConfirms:P},null,8,["modelValue"])):c("",!0)]),_:1})}}};export{se as default};

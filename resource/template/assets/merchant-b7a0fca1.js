import{g as de,r as x,a as s,b as k,c as y,w as t,d as e,u as o,i as p,n as D,k as w,j as U}from"./index-343df799.js";const pe={__name:"merchant",setup(re){const{proxy:g}=de();let V=x({}),c=x({}),u=x({}),R=x({}),n=x(!1),$=x(!1),b=x(""),E=x({name:[{required:!0,message:"请输入商户名称",trigger:"blur"}],code:[{required:!0,pattern:/^(\w){6,16}$/,message:"请设置6-16位字母、数字组合数字编码",trigger:"blur"}],exchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],onecost:[{required:!0,message:"请输入单笔手续费",trigger:"blur"}],nikname:[{required:!0,message:"请输入商户标签",trigger:"blur"}],downpoint:[{required:!0,message:"请设置商户交易费浮动",trigger:"blur"}]});function v(){g.$refs.baseTableRef.refresh()}function G(){u.value={status:!0,backpay:!0,downpoint:0},b.value="add",n.value=!0}function L(r){u.value=Object.assign({},r),b.value="update",n.value=!0}async function N(r){let a=await g.$api.merchant.delete(r.id);v(),g.submitOk(a.message)}function H(){g.$refs.dataFormRef.validate(async r=>{if(r){let a=await g.$api.merchant[u.value.id?"update":"add"](u.value);g.submitOk(a.message),v(),n.value=!1}})}function J(r){b.value="checkchannel",n.value=!0}function K(r){R.value=Object.assign({id:r.id,version:r.version}),b.value="setagent",n.value=!0}async function M(){let r=await g.$api.merchant.putagent(R.value);g.submitOk(r.message),v(),n.value=!1}function W(r){b.value="balancerecord",n.value=!0}function X(r){c.value={merchantid:r.id},b.value="aislerecord",n.value=!0}function Y(){$.value=!0,n.value=!0}async function Z(r){let a=await g.$api.merchantaisle.add({aisleid:r,merchantid:c.value.merchantid});g.submitOk(a.message),$.value=!1,O()}async function ee(r){let a=await g.$api.merchantaisle.delete(r.id);O(),g.submitOk(a.message)}function O(){g.$refs.baseAisleTableRef.refresh()}function le(){b.value="add",n.value=!1}return(r,a)=>{const A=s("base-input"),C=s("el-col"),P=s("base-select-no"),i=s("el-button"),Q=s("el-row"),z=s("base-header"),d=s("el-table-column"),S=s("base-switch"),q=s("el-tag"),j=s("base-delete-btn"),F=s("base-table-p"),I=s("base-content"),_=s("base-input-no"),m=s("el-form-item"),ae=s("el-input-number"),h=s("base-radio-group"),B=s("el-form"),T=s("base-dialog"),te=s("base-cascader"),oe=s("base-cascader-no"),ne=s("choose-aisle-dialog"),ue=s("base-wrapper");return k(),y(ue,null,{default:t(()=>[e(z,null,{default:t(()=>[e(Q,null,{default:t(()=>[e(C,{span:4.5},{default:t(()=>[e(A,{modelValue:o(V).name,"onUpdate:modelValue":a[0]||(a[0]=l=>o(V).name=l),label:"商户名称",onClear:v},null,8,["modelValue"])]),_:1}),e(C,{span:4.5},{default:t(()=>[e(A,{modelValue:o(V).code,"onUpdate:modelValue":a[1]||(a[1]=l=>o(V).code=l),label:"商户编码",onClear:v},null,8,["modelValue"])]),_:1}),e(C,{span:4.5},{default:t(()=>[e(A,{modelValue:o(V).nikname,"onUpdate:modelValue":a[2]||(a[2]=l=>o(V).nikname=l),label:"商户标签",onClear:v},null,8,["modelValue"])]),_:1}),e(C,{span:4.5},{default:t(()=>[e(P,{modelValue:o(V).status,"onUpdate:modelValue":a[3]||(a[3]=l=>o(V).status=l),label:"状态","tag-type":"success",onClear:v,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:r.statusList},null,8,["modelValue","dataList"])]),_:1}),e(C,{span:4.5},{default:t(()=>[e(A,{modelValue:o(V).agentname,"onUpdate:modelValue":a[4]||(a[4]=l=>o(V).agentname=l),label:"代理名称",onClear:v},null,8,["modelValue"])]),_:1}),e(C,{span:4.5},{default:t(()=>[e(i,{type:"primary",onClick:v},{default:t(()=>[p("查询")]),_:1}),e(i,{type:"success",onClick:G},{default:t(()=>[p("添加")]),_:1})]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(F,{ref:"baseTableRef",api:"merchant.page",params:o(V),indexCode:!0},{default:t(()=>[e(d,{label:"商户名称",prop:"name"}),e(d,{label:"商户编码",prop:"code"}),e(d,{label:"标签",prop:"nikname"}),e(d,{label:"余额",prop:"balance"}),e(d,{label:"状态"},{default:t(l=>[e(S,{modelValue:l.row.status,"onUpdate:modelValue":f=>l.row.status=f,api:"merchant.update",params:{id:l.row.id,status:!l.row.status}},null,8,["modelValue","onUpdate:modelValue","params"])]),_:1}),e(d,{label:"当日手续费",prop:"todaycost"}),e(d,{label:"今日量",prop:"todaycount"}),e(d,{label:"总量",prop:"count"}),e(d,{label:"上次时间",prop:"update_time"}),e(d,{label:"交易费率‰",prop:"exchange"},{default:t(l=>[l.row.exchange?(k(),y(q,{key:0,type:"success"},{default:t(()=>[p(D(l.row.exchange)+"‰",1)]),_:2},1024)):w("",!0)]),_:1}),e(d,{label:"单笔手续费",prop:"onecost"}),e(d,{label:"充值汇率浮动",prop:"downpoint"}),e(d,{label:"代理名称",prop:"agentname"},{default:t(l=>[l.row.agentname?(k(),y(q,{key:0},{default:t(()=>[p(D(l.row.agentname),1)]),_:2},1024)):w("",!0)]),_:1}),e(d,{label:"创建时间",prop:"create_time"}),e(d,{label:"备注",prop:"remark"}),e(d,{label:"操作",width:"200"},{default:t(l=>[e(i,{type:"primary",link:"",onClick:f=>L(l.row)},{default:t(()=>[p("编辑")]),_:2},1032,["onClick"]),e(i,{type:"warning",link:"",onClick:f=>J(l.row)},{default:t(()=>[p("检测入单")]),_:2},1032,["onClick"]),e(i,{type:"success",link:"",onClick:f=>K(l.row)},{default:t(()=>[p("设置代理")]),_:2},1032,["onClick"]),e(i,{type:"info",link:"",onClick:f=>X(l.row)},{default:t(()=>[p("通道管理")]),_:2},1032,["onClick"]),e(i,{type:"warning",link:"",onClick:f=>W(l.row)},{default:t(()=>[p("资金明细")]),_:2},1032,["onClick"]),e(j,{onOk:f=>N(l.row)},null,8,["onOk"])]),_:1})]),_:1},8,["params"])]),_:1}),o(b)==="add"||o(b)==="update"?(k(),y(T,{key:0,modelValue:o(n),"onUpdate:modelValue":a[19]||(a[19]=l=>U(n)?n.value=l:n=l),title:r.dialogTitleObj[o(b)],width:"50%"},{footer:t(()=>[e(i,{onClick:a[18]||(a[18]=l=>U(n)?n.value=!1:n=!1)},{default:t(()=>[p("取 消")]),_:1}),e(i,{type:"primary",onClick:H},{default:t(()=>[p("确 定")]),_:1})]),default:t(()=>[e(B,{inline:!0,ref:"dataFormRef",rules:o(E),model:o(u),"label-width":"110px"},{default:t(()=>[e(m,{label:"商户名称:",prop:"name"},{default:t(()=>[e(_,{modelValue:o(u).name,"onUpdate:modelValue":a[5]||(a[5]=l=>o(u).name=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"登录账号:",prop:"username"},{default:t(()=>[e(_,{modelValue:o(u).username,"onUpdate:modelValue":a[6]||(a[6]=l=>o(u).username=l),disabled:o(b)!="add"},null,8,["modelValue","disabled"])]),_:1}),e(m,{label:"商户编码:",prop:"code"},{default:t(()=>[e(_,{modelValue:o(u).code,"onUpdate:modelValue":a[7]||(a[7]=l=>o(u).code=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"登录密码:",prop:"password"},{default:t(()=>[e(_,{modelValue:o(u).password,"onUpdate:modelValue":a[8]||(a[8]=l=>o(u).password=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"商户标签:",prop:"nikname"},{default:t(()=>[e(_,{modelValue:o(u).nikname,"onUpdate:modelValue":a[9]||(a[9]=l=>o(u).nikname=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"交易费率:",prop:"exchange"},{default:t(()=>[e(_,{modelValue:o(u).exchange,"onUpdate:modelValue":a[10]||(a[10]=l=>o(u).exchange=l),tip:"‰",label:"千分比1-100整数",onkeyup:"value=value.replace(/[^\\d.]/g,'')"},null,8,["modelValue"])]),_:1}),e(m,{label:"充值汇率浮动:",prop:"downpoint"},{default:t(()=>[e(ae,{modelValue:o(u).downpoint,"onUpdate:modelValue":a[11]||(a[11]=l=>o(u).downpoint=l),precision:2,min:-.3,max:.3,step:.01,"controls-position":"right",size:"default"},null,8,["modelValue"])]),_:1}),e(m,{label:"状态:",prop:"status"},{default:t(()=>[e(h,{modelValue:o(u).status,"onUpdate:modelValue":a[12]||(a[12]=l=>o(u).status=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"单笔手续费:",prop:"onecost"},{default:t(()=>[e(_,{modelValue:o(u).onecost,"onUpdate:modelValue":a[13]||(a[13]=l=>o(u).onecost=l),onkeyup:"value=value.replace(/[^\\d.]/g,'')"},null,8,["modelValue"])]),_:1}),e(m,{label:"后台代付:",prop:"backpay"},{default:t(()=>[e(h,{modelValue:o(u).backpay,"onUpdate:modelValue":a[14]||(a[14]=l=>o(u).backpay=l),"data-type":"payout"},null,8,["modelValue"])]),_:1}),e(m,{label:"备注:"},{default:t(()=>[e(_,{modelValue:o(u).remark,"onUpdate:modelValue":a[15]||(a[15]=l=>o(u).remark=l),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),e(m,{label:"结算方式:",prop:"clearingtype"},{default:t(()=>[e(h,{modelValue:o(u).backpay,"onUpdate:modelValue":a[16]||(a[16]=l=>o(u).backpay=l),"data-type":"settlement"},null,8,["modelValue"])]),_:1}),e(m,{label:"登录ip:"},{default:t(()=>[e(_,{modelValue:o(u).ipaddress,"onUpdate:modelValue":a[17]||(a[17]=l=>o(u).ipaddress=l),rows:4,type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):w("",!0),o(b)==="checkchannel"?(k(),y(T,{key:1,modelValue:o(n),"onUpdate:modelValue":a[26]||(a[26]=l=>U(n)?n.value=l:n=l),title:"发起代付",width:"20%"},{footer:t(()=>[e(i,{onClick:a[24]||(a[24]=l=>U(n)?n.value=!1:n=!1)},{default:t(()=>[p("取消")]),_:1}),e(i,{type:"primary",onClick:a[25]||(a[25]=l=>r.submitPwd())},{default:t(()=>[p("确定")]),_:1})]),default:t(()=>[e(B,{inline:!0,ref:"dataFormRef",model:o(u),"label-width":"100px"},{default:t(()=>[e(m,{label:"收款账户名:"},{default:t(()=>[e(_,{modelValue:o(u).name,"onUpdate:modelValue":a[20]||(a[20]=l=>o(u).name=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"收款人卡号:"},{default:t(()=>[e(_,{modelValue:o(u).username,"onUpdate:modelValue":a[21]||(a[21]=l=>o(u).username=l)},null,8,["modelValue"])]),_:1}),e(m,{label:"付款金额:"},{default:t(()=>[e(_,{modelValue:o(u).code,"onUpdate:modelValue":a[22]||(a[22]=l=>o(u).code=l),onkeyup:"value=value.replace(/[^\\d.]/g,'')"},null,8,["modelValue"])]),_:1}),e(m,{label:"选择通道:"},{default:t(()=>[e(te,{modelValue:o(V).dept_id,"onUpdate:modelValue":a[23]||(a[23]=l=>o(V).dept_id=l),style:{"margin-right":"10px"},clearable:"",props:{value:"id",label:"name",children:"children",checkStrictly:!0,emitPath:!1},api:"sys_dept.tree"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])):w("",!0),o(b)==="setagent"?(k(),y(T,{key:2,modelValue:o(n),"onUpdate:modelValue":a[30]||(a[30]=l=>U(n)?n.value=l:n=l),title:"设置代理",width:"23%"},{footer:t(()=>[e(i,{onClick:a[28]||(a[28]=l=>U(n)?n.value=!1:n=!1)},{default:t(()=>[p("取消")]),_:1}),e(i,{type:"primary",onClick:a[29]||(a[29]=l=>M())},{default:t(()=>[p("确定")]),_:1})]),default:t(()=>[e(B,{inline:!0,model:o(R),"label-width":"70px"},{default:t(()=>[e(m,{label:"代理:"},{default:t(()=>[e(oe,{modelValue:o(R).agentid,"onUpdate:modelValue":a[27]||(a[27]=l=>o(R).agentid=l),style:{"margin-right":"10px"},clearable:"",props:{value:"id",label:"name",emitPath:!1},api:"agent.list"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])):w("",!0),o(b)==="aislerecord"?(k(),y(T,{key:3,modelValue:o(n),"onUpdate:modelValue":a[35]||(a[35]=l=>U(n)?n.value=l:n=l),title:"通道管理",width:"60%","destroy-on-close":!0,onClose:le},{default:t(()=>[o($)?(k(),y(ne,{key:0,modelValue:o($),"onUpdate:modelValue":a[31]||(a[31]=l=>U($)?$.value=l:$=l),"append-to-body":"",title:"添加通道",width:"50%",onChoose:Z},null,8,["modelValue"])):w("",!0),e(z,null,{default:t(()=>[e(Q,null,{default:t(()=>[e(C,{span:4.5},{default:t(()=>[e(A,{modelValue:o(c).name,"onUpdate:modelValue":a[32]||(a[32]=l=>o(c).name=l),label:"通道名称",onClear:O},null,8,["modelValue"])]),_:1}),e(C,{span:4.5},{default:t(()=>[e(A,{modelValue:o(c).code,"onUpdate:modelValue":a[33]||(a[33]=l=>o(c).code=l),label:"通道编码",onClear:O},null,8,["modelValue"])]),_:1}),e(P,{modelValue:o(c).status,"onUpdate:modelValue":a[34]||(a[34]=l=>o(c).status=l),label:"状态","tag-type":"success",onClear:O,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:r.statusList},null,8,["modelValue","dataList"]),e(C,{span:4.5},{default:t(()=>[e(i,{type:"primary",onClick:O},{default:t(()=>[p("查询")]),_:1}),e(i,{type:"success",onClick:Y},{default:t(()=>[p("添加通道")]),_:1})]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(F,{ref:"baseAisleTableRef",api:"merchantaisle.page",params:o(c)},{default:t(()=>[e(d,{label:"通道名称",prop:"name"}),e(d,{label:"编码",prop:"code"}),e(d,{label:"状态"},{default:t(l=>[e(S,{modelValue:l.row.status,"onUpdate:modelValue":f=>l.row.status=f,api:"aisle.update",params:{id:l.row.aisleid,status:!l.row.status}},null,8,["modelValue","onUpdate:modelValue","params"])]),_:1}),e(d,{label:"交易费率",prop:"exchange"},{default:t(l=>[l.row.exchange?(k(),y(q,{key:0,type:"success"},{default:t(()=>[p(D(l.row.exchange)+"%",1)]),_:2},1024)):w("",!0)]),_:1}),e(d,{label:"单笔手续费",prop:"onecost"}),e(d,{label:"备注",prop:"remark"}),e(d,{label:"操作"},{default:t(l=>[e(j,{onOk:f=>ee(l.row)},null,8,["onOk"])]),_:1})]),_:1},8,["params"])]),_:1})]),_:1},8,["modelValue"])):w("",!0),o(b)==="balancerecord"?(k(),y(T,{key:4,modelValue:o(n),"onUpdate:modelValue":a[36]||(a[36]=l=>U(n)?n.value=l:n=l),title:"资金明细",width:"80%"},{default:t(()=>[e(F,{ref:"baseTableRef",api:"aisle.page",params:o(V),indexCode:!0},{default:t(()=>[e(d,{label:"通道名称",prop:"name"}),e(d,{label:"编码",prop:"code"}),e(d,{label:"状态"},{default:t(l=>[e(S,{modelValue:l.row.status,"onUpdate:modelValue":f=>l.row.status=f,api:"aisle.update",params:{id:l.row.aisleid,status:!l.row.status}},null,8,["modelValue","onUpdate:modelValue","params"])]),_:1}),e(d,{label:"汇率",prop:"exchange"},{default:t(l=>[l.row.exchange?(k(),y(q,{key:0,type:"success"},{default:t(()=>[p(D(l.row.exchange)+"%",1)]),_:2},1024)):w("",!0)]),_:1}),e(d,{label:"单笔手续费",prop:"onecost"}),e(d,{label:"绑定渠道数",prop:"channelcount"}),e(d,{label:"备注",prop:"remark"}),e(d,{label:"创建时间",prop:"create_time"}),e(d,{label:"操作"},{default:t(l=>[e(i,{type:"primary",link:"",onClick:f=>L(l.row)},{default:t(()=>[p("编辑")]),_:2},1032,["onClick"]),e(i,{type:"success",link:"",onClick:f=>L(l.row)},{default:t(()=>[p("绑定渠道")]),_:2},1032,["onClick"]),e(j,{onOk:f=>N(l.row)},null,8,["onOk"])]),_:1})]),_:1},8,["params"])]),_:1},8,["modelValue"])):w("",!0)]),_:1})}}};export{pe as default};

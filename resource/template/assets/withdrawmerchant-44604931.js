import{g as Z,r as _,a as o,b as m,c,w as t,d as a,u as n,i as f,n as V,k as b,e as B,m as R,j as C,F as ee,q as ae}from"./index-fc9417a1.js";const le=["src"],te={style:{width:"300px"}},re={__name:"withdrawmerchant",setup(ne){const{proxy:i}=Z();i.$store.user.useUserStore();let r=_({}),s=_(!1),p=_(""),k=_({type:21}),U=_({}),O=_([]),T=_({merchantid:[{required:!0,message:"请选择商户",trigger:"blur"}],accnumber:[{required:!0,message:"请选择卡或地址",trigger:"blur"}],merchantexchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function g(){i.$refs.baseTableRef.refresh()}function q(){p.value="add",s.value=!0}function F(u){u!=null&&L(u)}async function L(u){let l=await i.$api.merchantaccount.getbank(u);O.value=l.body.listbanks,r.value={merchantid:u,totalincome:l.body.totalincome}}function S(u){U.value=u,p.value="confirm",s.value=!0}async function N(){p.value="add",s.value=!1;let u=await i.$api.merchantaccountorder.passwithdraw(U.value.id);i.submitOk(u.message),g()}async function P(u){let l=await i.$api.merchantaccountorder.turndownwithdraw(u.id);g(),i.submitOk(l.message)}function j(){i.$refs.dataFormRef.validate(async u=>{if(u){r.value.id=null;let l=await i.$api.merchantaccountorder.withdraw(r.value);i.submitOk(l.message),g(),s.value=!1}})}return(u,l)=>{const D=o("base-input"),v=o("el-col"),A=o("base-select-no"),y=o("el-button"),E=o("el-row"),I=o("base-header"),d=o("el-table-column"),x=o("el-tag"),$=o("base-confirm-btn"),M=o("base-table-p"),Q=o("base-content"),z=o("base-cascader-no"),w=o("el-form-item"),G=o("el-option"),H=o("el-select"),h=o("base-input-no"),J=o("el-form"),K=o("base-dialog"),W=o("authenticator-dialog"),X=o("base-wrapper");return m(),c(X,null,{default:t(()=>[a(I,null,{default:t(()=>[a(E,null,{default:t(()=>[a(v,{span:4.5},{default:t(()=>[a(D,{modelValue:n(k).nikname,"onUpdate:modelValue":l[0]||(l[0]=e=>n(k).nikname=e),label:"充值金额",onClear:g},null,8,["modelValue"])]),_:1}),a(v,{span:4.5},{default:t(()=>[a(A,{modelValue:n(k).status,"onUpdate:modelValue":l[1]||(l[1]=e=>n(k).status=e),label:"状态","tag-type":"success",onClear:g,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:u.statusList},null,8,["modelValue","dataList"])]),_:1}),a(v,{span:4.5},{default:t(()=>[a(y,{type:"primary",onClick:g},{default:t(()=>[f("查询")]),_:1}),a(y,{type:"success",onClick:q},{default:t(()=>[f("创建提现")]),_:1})]),_:1})]),_:1})]),_:1}),a(Q,null,{default:t(()=>[a(M,{ref:"baseTableRef",api:"merchantaccountorder.page",params:n(k),indexCode:!0},{default:t(()=>[a(d,{label:"提现单号",prop:"ordernum",width:"180px;"}),a(d,{label:"商户名称",prop:"username"}),a(d,{label:"商户编码",prop:"merchantcode"}),a(d,{label:"标签",prop:"nkname"}),a(d,{label:"账户名字",prop:"accname"}),a(d,{label:"卡号/地址",prop:"accnumber"}),a(d,{label:"结算汇率",prop:"merchantexchange"},{default:t(e=>[e.row.merchantexchange?(m(),c(x,{key:0,type:"danger"},{default:t(()=>[f(V(e.row.exchange)+"%",1)]),_:2},1024)):b("",!0)]),_:1}),a(d,{label:"到账RMB金额",prop:"accnumber"},{default:t(e=>[e.row.amountreceived?(m(),c(x,{key:0,type:"success"},{default:t(()=>[f(V(e.row.amountreceived),1)]),_:2},1024)):b("",!0)]),_:1}),a(d,{label:"状态"},{default:t(e=>[e.row.statusname?(m(),c(x,{key:0},{default:t(()=>[f(V(e.row.statusname),1)]),_:2},1024)):b("",!0)]),_:1}),a(d,{label:"支付凭证",prop:"avatarUrl"},{default:t(e=>[B("span",null,[e.row.imgurl?(m(),R("img",{key:0,src:e.row.imgurl,alt:"",class:"img-sm"},null,8,le)):b("",!0)])]),_:1}),a(d,{label:"创建时间",prop:"create_time"}),a(d,{label:"备注",prop:"remark",width:"180px;"}),a(d,{label:"操作",width:"100"},{default:t(e=>[e.row.status==10?(m(),c($,{key:0,type:"success",onOk:Y=>S(e.row),label:"确认"},null,8,["onOk"])):b("",!0),e.row.status==10?(m(),c($,{key:1,type:"warning",onOk:Y=>P(e.row),label:"拒绝"},null,8,["onOk"])):b("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(p)==="add"||n(p)==="update"?(m(),c(K,{key:0,modelValue:n(s),"onUpdate:modelValue":l[10]||(l[10]=e=>C(s)?s.value=e:s=e),title:u.dialogTitleObj[n(p)],width:"22%"},{footer:t(()=>[a(y,{onClick:l[9]||(l[9]=e=>C(s)?s.value=!1:s=!1)},{default:t(()=>[f("取 消")]),_:1}),a(y,{type:"primary",onClick:j},{default:t(()=>[f("确 定")]),_:1})]),default:t(()=>[a(J,{ref:"dataFormRef",rules:n(T),model:n(r),"label-width":"110px"},{default:t(()=>[a(w,{label:"选择商户:",prop:"merchantid"},{default:t(()=>[a(z,{modelValue:n(r).merchantid,"onUpdate:modelValue":l[2]||(l[2]=e=>n(r).merchantid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"merchant.list",onOk:l[3]||(l[3]=e=>F(n(r).merchantid))},null,8,["modelValue"])]),_:1}),a(w,{label:"卡/地址:",prop:"accnumber"},{default:t(()=>[a(H,{modelValue:n(r).accnumber,"onUpdate:modelValue":l[4]||(l[4]=e=>n(r).accnumber=e),placeholder:"请选择卡类型",style:{}},{default:t(()=>[(m(!0),R(ee,null,ae(n(O),e=>(m(),c(G,{key:e.id,value:e.id,label:e.accnumber},{default:t(()=>[B("span",te,V(e.accnumber),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(w,{label:"余额:"},{default:t(()=>[a(h,{modelValue:n(r).totalincome,"onUpdate:modelValue":l[5]||(l[5]=e=>n(r).totalincome=e),disabled:n(p)=="add"},null,8,["modelValue","disabled"])]),_:1}),a(w,{label:"结算汇率:",prop:"merchantexchange"},{default:t(()=>[a(h,{modelValue:n(r).merchantexchange,"onUpdate:modelValue":l[6]||(l[6]=e=>n(r).merchantexchange=e)},null,8,["modelValue"])]),_:1}),a(w,{label:"金额:",prop:"amount"},{default:t(()=>[a(h,{modelValue:n(r).amount,"onUpdate:modelValue":l[7]||(l[7]=e=>n(r).amount=e)},null,8,["modelValue"])]),_:1}),a(w,{label:"备注:",prop:"remark"},{default:t(()=>[a(h,{modelValue:n(r).remark,"onUpdate:modelValue":l[8]||(l[8]=e=>n(r).remark=e),type:"textarea",style:{width:"220px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):b("",!0),n(p)=="confirm"?(m(),c(W,{key:1,modelValue:n(s),"onUpdate:modelValue":l[11]||(l[11]=e=>C(s)?s.value=e:s=e),"append-to-body":"",title:"安全验证",width:"15%",onConfirms:N},null,8,["modelValue"])):b("",!0)]),_:1})}}};export{re as default};

import{g as G,r as f,a as r,b as v,c as C,w as n,d as e,u as a,i as V,n as H,k as q,j as h}from"./index-b2871155.js";const M={__name:"merchantpayout",setup(J){const{proxy:c}=G(),{userObj:k}=c.$store.user.useUserStore();let s=f({userid:k.id}),o=f({}),d=f(!1),g=f(""),U=f({userid:k.id}),R=f({aisleid:[{required:!0,message:"请选择通道",trigger:"blur"}],accnumer:[{required:!0,message:"请输入卡号",trigger:"blur"}],accname:[{required:!0,message:"请输入账户名",trigger:"blur"}],bankname:[{required:!0,message:"请输入银行名称",trigger:"blur"}],amount:[{required:!0,trigger:"change",validator:S}]});function S(m,l,p){return!l||l>o.value.totalincome?p(new Error("请输入金额,并且不能大于可用余额")):p()}function i(){c.$refs.baseTableRef.refresh()}function T(){$(),o.value={},g.value="add",d.value=!0}async function $(){let m=await c.$api.merchantaccount.bank();o.value={totalincome:m.body.balance}}function B(){c.$refs.dataFormRef.validate(async m=>{if(m){let l=await c.$api.payout[o.value.id?"update":"add"](o.value);c.submitOk(l.message),i(),d.value=!1}})}function j(m){o.value.accname=m.accname,o.value.accnumer=m.accnumber,o.value.bankname=m.bankname}return(m,l)=>{const p=r("base-input"),b=r("el-col"),F=r("base-select-no"),y=r("el-button"),L=r("el-row"),N=r("base-header"),u=r("el-table-column"),O=r("el-tag"),P=r("el-image"),A=r("base-table-p"),D=r("base-content"),x=r("base-cascader-no"),_=r("el-form-item"),w=r("base-input-no"),z=r("base-select-query"),E=r("el-form"),I=r("base-dialog"),Q=r("base-wrapper");return v(),C(Q,null,{default:n(()=>[e(N,null,{default:n(()=>[e(L,null,{default:n(()=>[e(b,{span:4.5},{default:n(()=>[e(p,{modelValue:a(s).name,"onUpdate:modelValue":l[0]||(l[0]=t=>a(s).name=t),label:"商户名称",onClear:i},null,8,["modelValue"])]),_:1}),e(b,{span:4.5},{default:n(()=>[e(p,{modelValue:a(s).code,"onUpdate:modelValue":l[1]||(l[1]=t=>a(s).code=t),label:"商户编码",onClear:i},null,8,["modelValue"])]),_:1}),e(b,{span:4.5},{default:n(()=>[e(p,{modelValue:a(s).nikname,"onUpdate:modelValue":l[2]||(l[2]=t=>a(s).nikname=t),label:"商户标签",onClear:i},null,8,["modelValue"])]),_:1}),e(b,{span:4.5},{default:n(()=>[e(F,{modelValue:a(s).status,"onUpdate:modelValue":l[3]||(l[3]=t=>a(s).status=t),label:"状态","tag-type":"success",onClear:i,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:m.statusList},null,8,["modelValue","dataList"])]),_:1}),e(b,{span:4.5},{default:n(()=>[e(p,{modelValue:a(s).agentname,"onUpdate:modelValue":l[4]||(l[4]=t=>a(s).agentname=t),label:"代理名称",onClear:i},null,8,["modelValue"])]),_:1}),e(b,{span:4.5},{default:n(()=>[e(y,{type:"primary",onClick:i},{default:n(()=>[V("查询")]),_:1}),e(y,{type:"success",onClick:T},{default:n(()=>[V("发起代付")]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:n(()=>[e(A,{ref:"baseTableRef",api:"payout.page",params:a(s),indexCode:!0,orderBy:"create_time",dir:"desc"},{default:n(()=>[e(u,{label:"系统订单号",prop:"ordernum"}),e(u,{label:"商户订单号",prop:"merchantordernum"}),e(u,{label:"通道",prop:"aislename"}),e(u,{label:"状态",prop:"statusname",width:"100"},{default:n(t=>[t.row.statusname?(v(),C(O,{key:0,type:"danger"},{default:n(()=>[V(H(t.row.statusname),1)]),_:2},1024)):q("",!0)]),_:1}),e(u,{label:"金额",prop:"amount",width:"80"}),e(u,{label:"账户名",prop:"accname",width:"80"}),e(u,{label:"卡号/地址",prop:"accnumer"}),e(u,{label:"银行名称",prop:"bankname",width:"120"}),e(u,{label:"创建时间",prop:"create_time"}),e(u,{label:"操作秒数",prop:"backlong",width:"80"}),e(u,{label:"完成时间",prop:"successtime"}),e(u,{label:"回执",width:"125"},{default:n(t=>[e(P,{style:{width:"50px",height:"50px"},src:t.row.imgurl,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[t.row.imgurl],"initial-index":4,"preview-teleported":"true",fit:"cover"},null,8,["src","preview-src-list"])]),_:1})]),_:1},8,["params"])]),_:1}),a(g)==="add"||a(g)==="update"?(v(),C(I,{key:0,modelValue:a(d),"onUpdate:modelValue":l[12]||(l[12]=t=>h(d)?d.value=t:d=t),title:m.dialogTitleObj[a(g)],width:"23%"},{footer:n(()=>[e(y,{onClick:l[11]||(l[11]=t=>h(d)?d.value=!1:d=!1)},{default:n(()=>[V("取 消")]),_:1}),e(y,{type:"primary",onClick:B},{default:n(()=>[V("确 定")]),_:1})]),default:n(()=>[e(E,{inline:!0,ref:"dataFormRef",rules:a(R),model:a(o),"label-width":"100px"},{default:n(()=>[e(_,{label:"选择通道:",prop:"aisleid"},{default:n(()=>[e(x,{modelValue:a(o).aisleid,"onUpdate:modelValue":l[5]||(l[5]=t=>a(o).aisleid=t),style:{"margin-right":"10px"},clearable:"",label:"",params:a(U),props:{value:"aisleid",label:"name",checkStrictly:!0,emitPath:!1},api:"merchantaisle.page"},null,8,["modelValue","params"])]),_:1}),e(_,{label:"可用余额:",prop:"totalincome"},{default:n(()=>[e(w,{modelValue:a(o).totalincome,"onUpdate:modelValue":l[6]||(l[6]=t=>a(o).totalincome=t),disabled:a(g)=="add"},null,8,["modelValue","disabled"])]),_:1}),e(_,{label:"金额",prop:"amount"},{default:n(()=>[e(w,{modelValue:a(o).amount,"onUpdate:modelValue":l[7]||(l[7]=t=>a(o).amount=t),onkeyup:"value=value.replace(/[^\\d.]/g,'')"},null,8,["modelValue"])]),_:1}),e(_,{label:"姓名:",prop:"accname"},{default:n(()=>[e(z,{api:"merchantbanks.page",params:{userid:a(k).id},query:"accname",modelValue:a(o).accname,"onUpdate:modelValue":l[8]||(l[8]=t=>a(o).accname=t),onChoose:j},null,8,["params","modelValue"])]),_:1}),e(_,{label:"账号:",prop:"accnumer"},{default:n(()=>[e(w,{modelValue:a(o).accnumer,"onUpdate:modelValue":l[9]||(l[9]=t=>a(o).accnumer=t)},null,8,["modelValue"])]),_:1}),e(_,{label:"银行名称:",prop:"bankname"},{default:n(()=>[e(x,{modelValue:a(o).bankname,"onUpdate:modelValue":l[10]||(l[10]=t=>a(o).bankname=t),style:{"margin-right":"10px"},clearable:"",label:"",params:a(U),props:{value:"name",label:"name",checkStrictly:!0,emitPath:!1},api:"sys_bank.list"},null,8,["modelValue","params"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):q("",!0)]),_:1})}}};export{M as default};

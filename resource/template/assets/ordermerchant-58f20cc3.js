import{g as X,r as w,a as o,b,c as _,w as t,d as a,u as n,i as p,n as v,k as f,j as x}from"./index-5dc5873c.js";const ee={__name:"ordermerchant",setup(Y){const{proxy:d}=X();let r=w({}),u=w(!1),g=w(""),C=w({}),i=w({type:20}),R=w({merchantid:[{required:!0,message:"请选择商户",trigger:"blur"}],accnumber:[{required:!0,message:"请选择卡或地址",trigger:"blur"}],merchantexchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function c(){d.$refs.baseTableRef.refresh()}function T(){r.value={},U(),g.value="add",u.value=!0}async function U(){let s=await d.$api.payconfig.get();r.value=s.body,d.submitOk(s.message)}function q(s){C.value=s,g.value="confirm",u.value=!0}async function S(){g.value="add",u.value=!1;let s=await d.$api.merchantaccountorder.pass(C.value.id);d.submitOk(s.message),c()}async function B(s){let l=await d.$api.merchantaccountorder.turndown(s.id);c(),d.submitOk(l.message)}function F(){d.$refs.dataFormRef.validate(async s=>{if(s){r.value.id=null;let l=await d.$api.merchantaccountorder[r.value.id?"update":"add"](r.value);d.submitOk(l.message),c(),u.value=!1}})}async function L(s){let l=await d.$api.merchant.get(s);r.value.merchantexchange=l.body.downpoint}return(s,l)=>{const O=o("base-input"),N=o("base-select-no"),P=o("base-datetime"),j=o("base-datetime-no"),y=o("el-button"),D=o("el-col"),z=o("el-row"),A=o("base-header"),m=o("el-table-column"),h=o("el-tag"),E=o("el-image"),$=o("base-confirm-btn"),I=o("base-table-p"),M=o("base-content"),Q=o("base-cascader-no"),V=o("el-form-item"),k=o("base-input-no"),G=o("el-form"),H=o("base-dialog"),J=o("authenticator-dialog"),K=o("base-wrapper");return b(),_(K,null,{default:t(()=>[a(A,null,{default:t(()=>[a(z,null,{default:t(()=>[a(D,null,{default:t(()=>[a(O,{modelValue:n(i).agentname,"onUpdate:modelValue":l[0]||(l[0]=e=>n(i).agentname=e),label:"商户名称",onClear:c},null,8,["modelValue"]),a(O,{modelValue:n(i).agentname,"onUpdate:modelValue":l[1]||(l[1]=e=>n(i).agentname=e),label:"商户编码",onClear:c},null,8,["modelValue"]),a(N,{modelValue:n(i).status,"onUpdate:modelValue":l[2]||(l[2]=e=>n(i).status=e),label:"状态","tag-type":"success",onClear:c,style:{"margin-right":"5px",width:"200px"},clearable:"","option-props":{label:"name",value:"value"},dataList:s.statusList},null,8,["modelValue","dataList"]),a(P,{modelValue:n(i).agentname,"onUpdate:modelValue":l[3]||(l[3]=e=>n(i).agentname=e),label:"时间",onClear:c},null,8,["modelValue"]),p("至 "),a(j,{modelValue:n(i).agentname,"onUpdate:modelValue":l[4]||(l[4]=e=>n(i).agentname=e),onClear:c},null,8,["modelValue"]),a(y,{type:"primary",onClick:c},{default:t(()=>[p("查询")]),_:1}),a(y,{type:"success",onClick:T},{default:t(()=>[p("商户充值")]),_:1})]),_:1})]),_:1})]),_:1}),a(M,null,{default:t(()=>[a(I,{ref:"baseTableRef",api:"merchantaccountorder.page",params:n(i),indexCode:!0},{default:t(()=>[a(m,{label:"商户名称",prop:"username"}),a(m,{label:"商户编码",prop:"merchantcode"}),a(m,{label:"标签",prop:"nkname"}),a(m,{label:"充值U金额",prop:"amount"}),a(m,{label:"充值汇率",prop:"exchange"},{default:t(e=>[e.row.exchange?(b(),_(h,{key:0,type:"success"},{default:t(()=>[p(v(e.row.exchange)+"%",1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"充值汇率浮动",prop:"merchantexchange"},{default:t(e=>[e.row.merchantexchange?(b(),_(h,{key:0,type:"success"},{default:t(()=>[p(v(e.row.merchantexchange),1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"到账RMB金额",prop:"amountreceived"},{default:t(e=>[e.row.amountreceived?(b(),_(h,{key:0,type:"success"},{default:t(()=>[p(v(e.row.amountreceived),1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"状态"},{default:t(e=>[e.row.statusname?(b(),_(h,{key:0},{default:t(()=>[p(v(e.row.statusname),1)]),_:2},1024)):f("",!0)]),_:1}),a(m,{label:"创建时间",prop:"create_time"}),a(m,{label:"凭证",prop:"imgurl"},{default:t(e=>[a(E,{style:{width:"50px",height:"50px"},src:e.row.imgurl,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.row.imgurl],"initial-index":4,"preview-teleported":"true",fit:"cover"},null,8,["src","preview-src-list"])]),_:1}),a(m,{label:"备注",prop:"remark"}),a(m,{label:"操作",width:"100"},{default:t(e=>[e.row.status==10?(b(),_($,{key:0,type:"success",onOk:W=>q(e.row),label:"确认"},null,8,["onOk"])):f("",!0),e.row.status==10?(b(),_($,{key:1,type:"warning",onOk:W=>B(e.row),label:"拒绝"},null,8,["onOk"])):f("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(g)==="add"||n(g)==="update"?(b(),_(H,{key:0,modelValue:n(u),"onUpdate:modelValue":l[11]||(l[11]=e=>x(u)?u.value=e:u=e),title:s.dialogTitleObj[n(g)],width:"27%"},{footer:t(()=>[a(y,{onClick:l[10]||(l[10]=e=>x(u)?u.value=!1:u=!1)},{default:t(()=>[p("取 消")]),_:1}),a(y,{type:"primary",onClick:F},{default:t(()=>[p("确 定")]),_:1})]),default:t(()=>[a(G,{ref:"dataFormRef",rules:n(R),model:n(r),"label-width":"110px"},{default:t(()=>[a(V,{label:"选择商户:",prop:"merchantid"},{default:t(()=>[a(Q,{modelValue:n(r).merchantid,"onUpdate:modelValue":l[5]||(l[5]=e=>n(r).merchantid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"merchant.list",onOk:L},null,8,["modelValue"])]),_:1}),a(V,{label:"充值金额:",prop:"amount"},{default:t(()=>[a(k,{modelValue:n(r).amount,"onUpdate:modelValue":l[6]||(l[6]=e=>n(r).amount=e)},null,8,["modelValue"])]),_:1}),a(V,{label:"充值汇率:"},{default:t(()=>[a(k,{modelValue:n(r).exchange,"onUpdate:modelValue":l[7]||(l[7]=e=>n(r).exchange=e)},null,8,["modelValue"]),a(y,{style:{"margin-left":"10px"},type:"warning",onClick:U},{default:t(()=>[p("刷新")]),_:1})]),_:1}),a(V,{label:"充值汇率浮动:",prop:"merchantexchange"},{default:t(()=>[a(k,{modelValue:n(r).merchantexchange,"onUpdate:modelValue":l[8]||(l[8]=e=>n(r).merchantexchange=e),label:"上下浮动汇率"},null,8,["modelValue"])]),_:1}),a(V,{label:"备注:",prop:"remark"},{default:t(()=>[a(k,{modelValue:n(r).remark,"onUpdate:modelValue":l[9]||(l[9]=e=>n(r).remark=e),type:"textarea",style:{width:"215px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):f("",!0),n(g)=="confirm"?(b(),_(J,{key:1,modelValue:n(u),"onUpdate:modelValue":l[12]||(l[12]=e=>x(u)?u.value=e:u=e),"append-to-body":"",title:"安全验证",width:"15%",onConfirms:S},null,8,["modelValue"])):f("",!0)]),_:1})}}};export{ee as default};

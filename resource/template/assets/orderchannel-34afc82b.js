import{g as H,r as g,a as o,b as i,c as p,w as l,d as a,u as n,i as c,n as v,k as _,j as C}from"./index-fc9417a1.js";const W={__name:"orderchannel",setup(J){const{proxy:m}=H();let u=g({}),r=g(!1),b=g(""),U=g({}),y=g({type:20}),R=g({channelid:[{required:!0,message:"请选择渠道",trigger:"blur"}],exchange:[{required:!0,message:"请输入汇率",trigger:"blur"}],channelexchange:[{required:!0,message:"请输入浮动汇率",trigger:"blur"}],amount:[{required:!0,message:"请输入金额",trigger:"blur"}]});function f(){m.$refs.baseTableRef.refresh()}function T(){u.value={},O(),b.value="add",r.value=!0}async function O(){let s=await m.$api.payconfig.get();u.value=s.body,m.submitOk(s.message)}function q(s){U.value=s,b.value="confirm",r.value=!0}async function B(){b.value="add",r.value=!1;let s=await m.$api.channelaccountorder.pass(U.value.id);m.submitOk(s.message),f()}async function F(s){let t=await m.$api.channelaccountorder.turndown(s.id);f(),m.submitOk(t.message)}function L(){m.$refs.dataFormRef.validate(async s=>{if(s){u.value.id=null;let t=await m.$api.channelaccountorder[u.value.id?"update":"add"](u.value);m.submitOk(t.message),f(),r.value=!1}})}return(s,t)=>{const N=o("base-input"),x=o("el-col"),P=o("base-select-no"),h=o("el-button"),S=o("el-row"),j=o("base-header"),d=o("el-table-column"),w=o("el-tag"),$=o("base-confirm-btn"),D=o("base-table-p"),A=o("base-content"),E=o("base-cascader-no"),k=o("el-form-item"),V=o("base-input-no"),I=o("el-form"),M=o("base-dialog"),Q=o("authenticator-dialog"),z=o("base-wrapper");return i(),p(z,null,{default:l(()=>[a(j,null,{default:l(()=>[a(S,null,{default:l(()=>[a(x,{span:4.5},{default:l(()=>[a(N,{modelValue:n(y).nikname,"onUpdate:modelValue":t[0]||(t[0]=e=>n(y).nikname=e),label:"充值金额",onClear:f},null,8,["modelValue"])]),_:1}),a(x,{span:4.5},{default:l(()=>[a(P,{modelValue:n(y).status,"onUpdate:modelValue":t[1]||(t[1]=e=>n(y).status=e),label:"状态","tag-type":"success",onClear:f,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:s.statusList},null,8,["modelValue","dataList"])]),_:1}),a(x,{span:4.5},{default:l(()=>[a(h,{type:"primary",onClick:f},{default:l(()=>[c("查询")]),_:1}),a(h,{type:"success",onClick:T},{default:l(()=>[c("创建充值")]),_:1})]),_:1})]),_:1})]),_:1}),a(A,null,{default:l(()=>[a(D,{ref:"baseTableRef",api:"channelaccountorder.page",params:n(y),indexCode:!0},{default:l(()=>[a(d,{label:"商户名称",prop:"username"}),a(d,{label:"商户编码",prop:"channelcode"}),a(d,{label:"标签",prop:"nkname"}),a(d,{label:"充值U金额",prop:"amount"}),a(d,{label:"汇率",prop:"exchange"},{default:l(e=>[e.row.exchange?(i(),p(w,{key:0,type:"success"},{default:l(()=>[c(v(e.row.exchange)+"%",1)]),_:2},1024)):_("",!0)]),_:1}),a(d,{label:"结算汇率",prop:"channelexchange"},{default:l(e=>[e.row.channelexchange?(i(),p(w,{key:0,type:"success"},{default:l(()=>[c(v(e.row.channelexchange)+"%",1)]),_:2},1024)):_("",!0)]),_:1}),a(d,{label:"到账RMB金额",prop:"amountreceived"},{default:l(e=>[e.row.amountreceived?(i(),p(w,{key:0,type:"success"},{default:l(()=>[c(v(e.row.amountreceived),1)]),_:2},1024)):_("",!0)]),_:1}),a(d,{label:"状态"},{default:l(e=>[e.row.statusname?(i(),p(w,{key:0},{default:l(()=>[c(v(e.row.statusname),1)]),_:2},1024)):_("",!0)]),_:1}),a(d,{label:"创建时间",prop:"create_time"}),a(d,{label:"备注",prop:"remark"}),a(d,{label:"操作",width:"100"},{default:l(e=>[e.row.status==10?(i(),p($,{key:0,type:"success",onOk:G=>q(e.row),label:"确认"},null,8,["onOk"])):_("",!0),e.row.status==10?(i(),p($,{key:1,type:"warning",onOk:G=>F(e.row),label:"拒绝"},null,8,["onOk"])):_("",!0)]),_:1})]),_:1},8,["params"])]),_:1}),n(b)==="add"||n(b)==="update"?(i(),p(M,{key:0,modelValue:n(r),"onUpdate:modelValue":t[8]||(t[8]=e=>C(r)?r.value=e:r=e),title:s.dialogTitleObj[n(b)],width:"21%"},{footer:l(()=>[a(h,{onClick:t[7]||(t[7]=e=>C(r)?r.value=!1:r=!1)},{default:l(()=>[c("取 消")]),_:1}),a(h,{type:"primary",onClick:L},{default:l(()=>[c("确 定")]),_:1})]),default:l(()=>[a(I,{ref:"dataFormRef",rules:n(R),model:n(u),"label-width":"100px"},{default:l(()=>[a(k,{label:"选择商户:",prop:"channelid"},{default:l(()=>[a(E,{modelValue:n(u).channelid,"onUpdate:modelValue":t[2]||(t[2]=e=>n(u).channelid=e),style:{"margin-right":"10px"},clearable:"",label:"",props:{value:"id",label:"name",checkStrictly:!0,emitPath:!1},api:"channel.list"},null,8,["modelValue"])]),_:1}),a(k,{label:"充值金额:",prop:"amount"},{default:l(()=>[a(V,{modelValue:n(u).amount,"onUpdate:modelValue":t[3]||(t[3]=e=>n(u).amount=e)},null,8,["modelValue"])]),_:1}),a(k,{label:"汇率:",prop:"exchange"},{default:l(()=>[a(V,{modelValue:n(u).exchange,"onUpdate:modelValue":t[4]||(t[4]=e=>n(u).exchange=e)},null,8,["modelValue"]),a(h,{style:{"margin-left":"10px"},type:"warning",onClick:O},{default:l(()=>[c("刷新")]),_:1})]),_:1}),a(k,{label:"汇率浮动:",prop:"channelexchange"},{default:l(()=>[a(V,{modelValue:n(u).channelexchange,"onUpdate:modelValue":t[5]||(t[5]=e=>n(u).channelexchange=e),label:"浮动汇率,没有可填0"},null,8,["modelValue"])]),_:1}),a(k,{label:"备注:",prop:"remark"},{default:l(()=>[a(V,{modelValue:n(u).remark,"onUpdate:modelValue":t[6]||(t[6]=e=>n(u).remark=e),type:"textarea",style:{width:"300px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):_("",!0),n(b)=="confirm"?(i(),p(Q,{key:1,modelValue:n(r),"onUpdate:modelValue":t[9]||(t[9]=e=>C(r)?r.value=e:r=e),"append-to-body":"",title:"安全验证",width:"15%",onConfirms:B},null,8,["modelValue"])):_("",!0)]),_:1})}}};export{W as default};

import{g as G,r as f,a as r,b as w,c as C,w as o,d as e,u as a,i as v,n as H,k as U,j as x}from"./index-55143ade.js";const M={__name:"merchantpayout",setup(J){const{proxy:c}=G(),{userObj:y}=c.$store.user.useUserStore();let d=f({userid:y.id}),l=f({}),m=f(!1),g=f(""),q=f({userid:y.id}),L=f({aisleid:[{required:!0,message:"请选择通道",trigger:"blur"}],accnumer:[{required:!0,message:"请输入卡号",trigger:"blur"}],accname:[{required:!0,message:"请输入账户名",trigger:"blur"}],bankname:[{required:!0,message:"请输入银行名称",trigger:"blur"}],bankaddress:[{required:!0,message:"请输入银行地址",trigger:"blur"}],amount:[{required:!0,trigger:"change",validator:A}]});function A(u,t,p){return!t||t>l.value.totalincome?p(new Error("请输入金额,并且不能大于可用余额")):p()}function i(){c.$refs.baseTableRef.refresh()}function R(){T(),l.value={},g.value="add",m.value=!0}async function T(){let u=await c.$api.merchantaccount.bank();l.value={totalincome:u.body.balance}}function $(){c.$refs.dataFormRef.validate(async u=>{if(u){l.value.provinceCityAreaList&&(l.value.bankaddress=l.value.provinceCityAreaList[0],l.value.provinceCityAreaList.length>2&&(l.value.bankaddress=l.value.bankaddress+""+l.value.provinceCityAreaList[1]+l.value.provinceCityAreaList[2]));let t=await c.$api.payout[l.value.id?"update":"add"](l.value);c.submitOk(t.message),i(),m.value=!1}})}function B(u){l.value.accname=u.accname,l.value.accnumer=u.accnumber,l.value.bankname=u.bankname,l.value.bankcode=u.bankcode,l.value.bankaddress=u.bankaddress}return(u,t)=>{const p=r("base-input"),_=r("el-col"),S=r("base-select-no"),k=r("el-button"),j=r("el-row"),F=r("base-header"),s=r("el-table-column"),N=r("el-tag"),O=r("el-image"),h=r("base-table-p"),D=r("base-content"),P=r("base-cascader-no"),b=r("el-form-item"),V=r("base-input-no"),z=r("base-select-query"),E=r("el-form"),I=r("base-dialog"),Q=r("base-wrapper");return w(),C(Q,null,{default:o(()=>[e(F,null,{default:o(()=>[e(j,null,{default:o(()=>[e(_,{span:4.5},{default:o(()=>[e(p,{modelValue:a(d).name,"onUpdate:modelValue":t[0]||(t[0]=n=>a(d).name=n),label:"商户名称",onClear:i},null,8,["modelValue"])]),_:1}),e(_,{span:4.5},{default:o(()=>[e(p,{modelValue:a(d).code,"onUpdate:modelValue":t[1]||(t[1]=n=>a(d).code=n),label:"商户编码",onClear:i},null,8,["modelValue"])]),_:1}),e(_,{span:4.5},{default:o(()=>[e(p,{modelValue:a(d).nikname,"onUpdate:modelValue":t[2]||(t[2]=n=>a(d).nikname=n),label:"商户标签",onClear:i},null,8,["modelValue"])]),_:1}),e(_,{span:4.5},{default:o(()=>[e(S,{modelValue:a(d).status,"onUpdate:modelValue":t[3]||(t[3]=n=>a(d).status=n),label:"状态","tag-type":"success",onClear:i,style:{"margin-right":"10px"},clearable:"","option-props":{label:"name",value:"value"},dataList:u.statusList},null,8,["modelValue","dataList"])]),_:1}),e(_,{span:4.5},{default:o(()=>[e(p,{modelValue:a(d).agentname,"onUpdate:modelValue":t[4]||(t[4]=n=>a(d).agentname=n),label:"代理名称",onClear:i},null,8,["modelValue"])]),_:1}),e(_,{span:4.5},{default:o(()=>[e(k,{type:"primary",onClick:i},{default:o(()=>[v("查询")]),_:1}),e(k,{type:"success",onClick:R},{default:o(()=>[v("发起代付")]),_:1})]),_:1})]),_:1})]),_:1}),e(D,null,{default:o(()=>[e(h,{ref:"baseTableRef",api:"payout.page",params:a(d),indexCode:!0,orderBy:"create_time",dir:"desc"},{default:o(()=>[e(s,{label:"系统订单号",prop:"ordernum"}),e(s,{label:"商户订单号",prop:"merchantordernum"}),e(s,{label:"通道",prop:"aislename"}),e(s,{label:"状态",prop:"statusname",width:"100"},{default:o(n=>[n.row.statusname?(w(),C(N,{key:0,type:"danger"},{default:o(()=>[v(H(n.row.statusname),1)]),_:2},1024)):U("",!0)]),_:1}),e(s,{label:"金额",prop:"amount",width:"80"}),e(s,{label:"账户名",prop:"accname",width:"80"}),e(s,{label:"卡号/地址",prop:"accnumer"}),e(s,{label:"银行名称",prop:"bankname",width:"120"}),e(s,{label:"创建时间",prop:"create_time"}),e(s,{label:"操作秒数",prop:"backlong",width:"80"}),e(s,{label:"完成时间",prop:"successtime"}),e(s,{label:"回执",width:"125"},{default:o(n=>[e(O,{style:{width:"50px",height:"50px"},src:n.row.imgurl,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[n.row.imgurl],"initial-index":4,"preview-teleported":"true",fit:"cover"},null,8,["src","preview-src-list"])]),_:1})]),_:1},8,["params"])]),_:1}),a(g)==="add"||a(g)==="update"?(w(),C(I,{key:0,modelValue:a(m),"onUpdate:modelValue":t[13]||(t[13]=n=>x(m)?m.value=n:m=n),title:u.dialogTitleObj[a(g)],width:"23%"},{footer:o(()=>[e(k,{onClick:t[12]||(t[12]=n=>x(m)?m.value=!1:m=!1)},{default:o(()=>[v("取 消")]),_:1}),e(k,{type:"primary",onClick:$},{default:o(()=>[v("确 定")]),_:1})]),default:o(()=>[e(E,{inline:!0,ref:"dataFormRef",rules:a(L),model:a(l),"label-width":"100px"},{default:o(()=>[e(b,{label:"选择通道:",prop:"aisleid"},{default:o(()=>[e(P,{modelValue:a(l).aisleid,"onUpdate:modelValue":t[5]||(t[5]=n=>a(l).aisleid=n),style:{"margin-right":"10px"},clearable:"",label:"",params:a(q),props:{value:"aisleid",label:"name",checkStrictly:!0,emitPath:!1},api:"merchantaisle.page"},null,8,["modelValue","params"])]),_:1}),e(b,{label:"可用余额:",prop:"totalincome"},{default:o(()=>[e(V,{modelValue:a(l).totalincome,"onUpdate:modelValue":t[6]||(t[6]=n=>a(l).totalincome=n),disabled:a(g)=="add"},null,8,["modelValue","disabled"])]),_:1}),e(b,{label:"金额",prop:"amount"},{default:o(()=>[e(V,{modelValue:a(l).amount,"onUpdate:modelValue":t[7]||(t[7]=n=>a(l).amount=n),onkeyup:"value=value.replace(/[^\\d.]/g,'')"},null,8,["modelValue"])]),_:1}),e(b,{label:"姓名:",prop:"accname"},{default:o(()=>[e(z,{api:"merchantcustomerbanks.page",params:{userid:a(y).id},query:"accname",modelValue:a(l).accname,"onUpdate:modelValue":t[8]||(t[8]=n=>a(l).accname=n),onChoose:B},null,8,["params","modelValue"])]),_:1}),e(b,{label:"账号:",prop:"accnumer"},{default:o(()=>[e(V,{modelValue:a(l).accnumer,"onUpdate:modelValue":t[9]||(t[9]=n=>a(l).accnumer=n)},null,8,["modelValue"])]),_:1}),e(b,{label:"银行名称:",prop:"bankname"},{default:o(()=>[e(V,{modelValue:a(l).bankname,"onUpdate:modelValue":t[10]||(t[10]=n=>a(l).bankname=n)},null,8,["modelValue"])]),_:1}),e(b,{label:"银行卡地址:",prop:"bankaddress"},{default:o(()=>[e(V,{modelValue:a(l).bankaddress,"onUpdate:modelValue":t[11]||(t[11]=n=>a(l).bankaddress=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])):U("",!0)]),_:1})}}};export{M as default};
